<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Epiverse-TRACE developer space</title>
<link>https://epiverse-trace.github.io/blog.html</link>
<atom:link href="https://epiverse-trace.github.io/blog.xml" rel="self" type="application/rss+xml"/>
<description>A place for Epiverse-TRACE developers to share their reflections, learnings, and showcase their work.</description>
<generator>quarto-1.5.47</generator>
<lastBuildDate>Mon, 24 Jun 2024 00:00:00 GMT</lastBuildDate>
<item>
  <title>epidemics v0.4.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/epidemics_v0.4.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new epidemics version v0.4.0. Here is an automatically generated summary of the changes in this version.</p>
<p>Maintainer is changing to <span class="citation" data-cites="rozeggo">@rozeggo</span>.</p>
<section id="model-functions" class="level2">
<h2 class="anchored" data-anchor-id="model-functions">Model functions</h2>
<ol type="1">
<li>Internal model functions for the models which allow vaccination have been corrected to prevent vaccination introducing negative values of susceptibles; tests added to check for this (#235, initially reported by <span class="citation" data-cites="avallecam">@avallecam</span>).</li>
</ol>
</section>
<section id="helper-functions" class="level2">
<h2 class="anchored" data-anchor-id="helper-functions">Helper functions</h2>
<ol type="1">
<li><p>Added the <code>epidemic_peak()</code> function to calculate the timing and size of the largest peak in each compartment in an scenario model (#240) by <span class="citation" data-cites="bahadzie">@bahadzie</span>.</p></li>
<li><p>Added the <code>outcomes_averted()</code> function to compare epidemic scenarios (e.g.&nbsp;with and without interventions or vaccination) (#225, #230).</p></li>
</ol>
</section>
<section id="documentation" class="level2">
<h2 class="anchored" data-anchor-id="documentation">Documentation</h2>
<ol type="1">
<li><p>Adds a developer-focused vignette on how to modify epidemics and model structures to address potential modelling requests or tasks (#210).</p></li>
<li><p>Splits up the ‘Modelling uncertainty and scenarios’ vignette into separate vignettes on uncertainty and scenario comparisons (#225).</p></li>
<li><p>Removed unnecessary plots from the vignette on modelling vaccination (#235).</p></li>
<li><p>Fixed link to <em>socialmixr</em> package in the ‘Get started’ and ‘Modelling interventions’ vignettes.</p></li>
<li><p>Updated and added documentation for all new or modified functions.</p></li>
<li><p>Updated references JSON file.</p></li>
</ol>
</section>
<section id="package" class="level2">
<h2 class="anchored" data-anchor-id="package">Package</h2>
<ol type="1">
<li><p>Updated Codecov GitHub Actions workflow to restore code coverage reporting.</p></li>
<li><p>Updated package title and citation file.</p></li>
<li><p>Updated <code>_pkgdown.yaml</code> with new vignette and updated section titles.</p></li>
<li><p>Updated WORDLIST.</p></li>
</ol>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Epidemics V0.4.0},
  date = {2024-06-24},
  url = {https://epiverse-trace.github.io/posts/epidemics_v0.4.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Epidemics
V0.4.0.”</span> June 24, 2024. <a href="https://epiverse-trace.github.io/posts/epidemics_v0.4.0/">https://epiverse-trace.github.io/posts/epidemics_v0.4.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/epidemics_v0.4.0/</guid>
  <pubDate>Mon, 24 Jun 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>cleanepi v1.0.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/cleanepi_v1.0.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new cleanepi version v1.0.0. Here is an automatically generated summary of the changes in this version.</p>
<section id="first-major-release" class="level2">
<h2 class="anchored" data-anchor-id="first-major-release">first major release</h2>
<p>Initial CRAN submission of <a href="https://epiverse-trace.github.io/cleanepi/"><code>{cleanepi}</code></a>, an R package designed for cleaning, curating, and standardizing epidemiological data.</p>
<p>This release includes the following key functionalities:</p>
<ol type="1">
<li><p><strong>Removing irregularities</strong>: It removes duplicated and empty rows and columns, as well as columns with constant values.</p></li>
<li><p><strong>Handling missing values</strong>: It replaces missing values with the standard <code>NA</code> format, ensuring consistency and ease of analysis.</p></li>
<li><p><strong>Ensuring data integrity</strong>: It ensures the uniqueness of uniquely identified columns, thus maintaining data integrity and preventing duplicates.</p></li>
<li><p><strong>Date conversion</strong>: It offers functionality to convert character columns to Date format under specific conditions, enhancing data uniformity and facilitating temporal analysis. It also offers conversion of numeric values written in letters into numbers.</p></li>
<li><p><strong>Standardizing entries</strong>: It can standardize column entries into specified formats, promoting consistency across the dataset.</p></li>
<li><p><strong>Time span calculation</strong>: It calculates the time span between two elements of type <code>Date</code>, providing valuable demographic insights for epidemiological analysis.</p></li>
<li><p><strong>Reporting cleaning outcome</strong>: It displays the report that reflects the changes made on the input data during the cleaning process, hence allowing the user to amend on the cleaning operations.</p></li>
</ol>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Cleanepi V1.0.0},
  date = {2024-06-17},
  url = {https://epiverse-trace.github.io/posts/cleanepi_v1.0.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Cleanepi
V1.0.0.”</span> June 17, 2024. <a href="https://epiverse-trace.github.io/posts/cleanepi_v1.0.0/">https://epiverse-trace.github.io/posts/cleanepi_v1.0.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/cleanepi_v1.0.0/</guid>
  <pubDate>Mon, 17 Jun 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>epichains v0.1.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/epichains_v0.1.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new epichains version v0.1.0. Here is an automatically generated summary of the changes in this version.</p>
<section id="epichains-0.1.0" class="level2">
<h2 class="anchored" data-anchor-id="epichains-0.1.0">epichains 0.1.0</h2>
<p>We are excited to announce the first minor release of <code>{epichains}</code>.</p>
<p><code>{epichains}</code> re-implements <a href="https://github.com/epiverse-trace/bpmodels">{bpmodels}</a>, focusing on a unified simulation framework using branching processes to simulate transmission chains data. The framework incorporates susceptible depletion and pre-existing immunity and provides dedicated data structures for handling and analysing transmission chains in both tabular and vector formats. The goal is to provide seamless interoperability with other packages within the Epiverse-TRACE Initiative and the broader epidemiological tool ecosystem.</p>
</section>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New Features</h2>
<section id="documentation" class="level3">
<h3 class="anchored" data-anchor-id="documentation">Documentation</h3>
<ul>
<li><strong>Dedicated Website:</strong> Explore all features and documentation on the <a href="https://epiverse-trace.github.io/epichains/">epichains website</a>.</li>
<li><strong>Help:</strong> Each function comes with extensive documentation. We welcome your feedback and suggestions for improvements.</li>
<li><strong>Vignettes:</strong> This release comes with five detailed vignettes:
<ul>
<li><strong>Getting Started:</strong> A quick guide to the key functions.</li>
<li><strong>Modelling Disease Control Interventions:</strong> Learn how to model various intervention strategies.</li>
<li><strong>Projecting Infectious Disease Incidence:</strong> A case study on projecting COVID-19 incidence.</li>
<li><strong>Literature:</strong> A curation of literature on branching process applications in epidemiology.</li>
<li><strong>Theoretical Background:</strong> A deep dive into the theoretical background of the functions in the package (Contributor documentation).</li>
<li><strong>Design principles</strong>: The design principles of <code>{epichains}</code> (Contributor documentation).</li>
</ul></li>
</ul>
</section>
<section id="simulation" class="level3">
<h3 class="anchored" data-anchor-id="simulation">Simulation</h3>
<ul>
<li><strong><code>simulate_chains()</code></strong>: Simulate independent transmission chains from a specified number of initial cases, incorporating susceptible depletion and pre-existing immunity.</li>
<li><strong><code>simulate_chain_stats()</code></strong>: Generate a vector of chain sizes or lengths from a specified number of initial cases, incorporating susceptible depletion and pre-existing immunity.</li>
</ul>
</section>
<section id="inference" class="level3">
<h3 class="anchored" data-anchor-id="inference">Inference</h3>
<ul>
<li><strong><code>likelihood()</code></strong>: Estimate the (log)likelihood of transmission chain sizes or lengths, with support for numeric vectors or <code>&lt;epichains&gt;</code> and <code>&lt;epichains_summary&gt;</code> objects.</li>
</ul>
</section>
<section id="transmission-chain-data-manipulation" class="level3">
<h3 class="anchored" data-anchor-id="transmission-chain-data-manipulation">Transmission Chain Data Manipulation</h3>
<ul>
<li><strong><code>summary()</code></strong>: Extract vectors of chain sizes or lengths from <code>&lt;epichains&gt;</code> objects.</li>
<li><strong><code>aggregate()</code></strong>: Generate case time series by aggregating by generation or time of infection.</li>
<li><strong><code>plot()</code></strong>: Visualize individual transmission chains filtered by their id.</li>
</ul>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Epichains V0.1.0},
  date = {2024-06-10},
  url = {https://epiverse-trace.github.io/posts/epichains_v0.1.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Epichains
V0.1.0.”</span> June 10, 2024. <a href="https://epiverse-trace.github.io/posts/epichains_v0.1.0/">https://epiverse-trace.github.io/posts/epichains_v0.1.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/epichains_v0.1.0/</guid>
  <pubDate>Mon, 10 Jun 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>readepi v0.1.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/readepi_v0.1.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new readepi version v0.1.0. Here is an automatically generated summary of the changes in this version.</p>
<p>This release contains the initial implementation of the package where data import from health information systems (HIS) depends on existing R packages designed specifically to retrieve data from a given HIS.</p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Readepi V0.1.0},
  date = {2024-06-10},
  url = {https://epiverse-trace.github.io/posts/readepi_v0.1.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Readepi
V0.1.0.”</span> June 10, 2024. <a href="https://epiverse-trace.github.io/posts/readepi_v0.1.0/">https://epiverse-trace.github.io/posts/readepi_v0.1.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/readepi_v0.1.0/</guid>
  <pubDate>Mon, 10 Jun 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>simulist v0.3.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/simulist_v0.3.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new simulist version v0.3.0. Here is an automatically generated summary of the changes in this version.</p>
<p>The third release of the <em>simulist</em> R package contains a range of new features, enhancements, documentation and unit tests.</p>
<p>The headline changes to the package are:</p>
<ul>
<li>The simulation is now parameterised with an infectious period rather than a contact interval.</li>
<li>Line list data now has <code>date_outcome</code> and <code>outcome</code> columns which can be parameterised with <code>onset_to_death</code> and <code>onset_to_recovery</code>.</li>
<li>Case fatality risk can vary through time with a customisable user-defined function.</li>
<li>Two new vignettes on time-varying case fatality risk, and wrangling line list and contact tracing data.</li>
</ul>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New features</h2>
<section id="external" class="level3">
<h3 class="anchored" data-anchor-id="external">External</h3>
<ul>
<li><p><code>onset_to_hosp</code> and <code>onset_to_death</code> arguments can now take <code>NA</code> as input and will return a column of <code>NA</code>s in the line list columns <code>date_admission</code> and <code>date_outcome</code> (#98).</p></li>
<li><p>An <code>onset_to_recovery</code> argument has been added to the simulation functions, <code>sim_linelist()</code> and <code>sim_outbreak()</code>, and so the recovery date can be explicitly given in the line list data (#99).</p></li>
<li><p>The line list simulation can now use a time-varying case fatality risk. The <code>create_config()</code> function now returns a <code>$time_varying_death_risk</code> list element, which is <code>NULL</code> by default but can take an R function to enable the fatality risk of cases to change over the epidemic (#101).</p></li>
<li><p>A new vignette, <code>time-varying-cfr.Rmd</code>, has been added to the package to describe how to use the time-varying case fatality risk functionality and describe a few different time-varying functions that can be used (#101).</p></li>
<li><p>A new vignette, <code>wrangling-linelist.Rmd</code>, has been added to go over some of the common post-processing steps that might be required after simulating line list or contact tracing data. This vignette is short and currently only contains a single post-processing example, more examples will be added over time (#104).</p></li>
<li><p>The <code>README</code> now has a section on related projects to provide an overview of packages that simulate line list data, or are related to <em>simulist</em>. This section contains a disclosure widget containing a feature table providing a high-level description of the features and development status of each related package (#110).</p></li>
<li><p>A Key features section and Complimentary R packages section has been added to the <code>README</code> (#134).</p></li>
<li><p>Updated package architecture diagram in the <code>design-principles.Rmd</code> vignette (#113).</p></li>
</ul>
</section>
<section id="internal" class="level3">
<h3 class="anchored" data-anchor-id="internal">Internal</h3>
<ul>
<li><p>The <code>.add_deaths()</code> function has been replaced by the <code>.add_outcome()</code> function which can simulate death and recovery times (#99).</p></li>
<li><p><code>.cross_check_sim_input()</code> function has been added to the package to ensure user input is coherent across arguments (#98).</p></li>
<li><p><code>.anonymise()</code> function has been added to convert individual’s names into alphanumeric codes to anonymise individuals in line list and contact tracing data (#106).</p></li>
</ul>
</section>
</section>
<section id="breaking-changes" class="level2">
<h2 class="anchored" data-anchor-id="breaking-changes">Breaking changes</h2>
<ul>
<li><p>The simulation functions are now parameterised with an infectious period (<code>infect_period</code> argument) instead of a contact interval (<code>contact_interval</code> argument). This moves away from parameterising the simulation with the time delay between a person becoming infected and having contact with a susceptible individual, and instead uses an infectious period distribution within which contacts are uniformly distributed in time (#96).</p></li>
<li><p>The simulation functions can now set a maximum as well as a minimum outbreak size. The <code>min_outbreak_size</code> argument in the exported <code>sim_*()</code> functions has been renamed <code>outbreak_size</code> and takes a <code>numeric</code> vector of two elements, the minimum and maximum outbreak size. The maximum outbreak size is a soft limit due to the stochastic nature of the branching process model, so epidemiological data returned can contain more cases and/or contacts that the maximum in <code>outbreak_size</code> but in these case a warning is returned explaining to the user how many cases/contacts are being returned (#93).</p></li>
<li><p>The <code>add_ct</code> argument in <code>sim_linelist()</code> and <code>sim_outbreak()</code> has been removed. The functionality is now equivalent to <code>add_ct = TRUE</code> in the previous <em>simulist</em> version. The <code>add_ct</code> argument was removed to move the package to always returning <code>&lt;data.frame&gt;</code>s with the same number of columns, for consistency and predictability (#104).</p></li>
<li><p>The <code>add_names</code> argument in the simulation functions has been renamed to <code>anonymise</code>. The new argument controls whether names are given to each case (<code>anonymise = FALSE</code>, default behaviour) or whether fixed length hexadecimal codes are given to each case (<code>anonymise = TRUE</code>), this ensures the returned <code>&lt;data.frame&gt;</code> has the same number of columns (#106).</p></li>
</ul>
</section>
<section id="bug-fixes" class="level2">
<h2 class="anchored" data-anchor-id="bug-fixes">Bug fixes</h2>
<ul>
<li><code>.sim_network_bp()</code> now indexes the time vector correctly. Previously a vector indexing bug meant the epidemic would not progress through time (#95).</li>
</ul>
</section>
<section id="deprecated-and-defunct" class="level2">
<h2 class="anchored" data-anchor-id="deprecated-and-defunct">Deprecated and defunct</h2>
<ul>
<li>None</li>
</ul>
</section>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>Many thanks to the contributors to this release, either from issues, code contributions, reviews or discussions (listed in alphabetical order):</p>
<p><a href="https://github.com/adamkucharski"><span class="citation" data-cites="adamkucharski">@adamkucharski</span></a>, <a href="https://github.com/avallecam"><span class="citation" data-cites="avallecam">@avallecam</span></a>, <a href="https://github.com/Bisaloo"><span class="citation" data-cites="Bisaloo">@Bisaloo</span></a>, <a href="https://github.com/CarmenTamayo"><span class="citation" data-cites="CarmenTamayo">@CarmenTamayo</span></a>, <a href="https://github.com/chartgerink"><span class="citation" data-cites="chartgerink">@chartgerink</span></a>, <a href="https://github.com/jamesmbaazam"><span class="citation" data-cites="jamesmbaazam">@jamesmbaazam</span></a>, <a href="https://github.com/ntncmch"><span class="citation" data-cites="ntncmch">@ntncmch</span></a>, <a href="https://github.com/PaulC91"><span class="citation" data-cites="PaulC91">@PaulC91</span></a>, <a href="https://github.com/pratikunterwegs"><span class="citation" data-cites="pratikunterwegs">@pratikunterwegs</span></a>, and <a href="https://github.com/sbfnk"><span class="citation" data-cites="sbfnk">@sbfnk</span></a>.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Simulist V0.3.0},
  date = {2024-06-03},
  url = {https://epiverse-trace.github.io/posts/simulist_v0.3.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Simulist
V0.3.0.”</span> June 3, 2024. <a href="https://epiverse-trace.github.io/posts/simulist_v0.3.0/">https://epiverse-trace.github.io/posts/simulist_v0.3.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/simulist_v0.3.0/</guid>
  <pubDate>Mon, 03 Jun 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>epiparameter v0.1.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/epiparameter_v0.1.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new epiparameter version v0.1.0. Here is an automatically generated summary of the changes in this version.</p>
<p>Initial release of the {epiparameter} R package. {epiparameter} provides:</p>
<ol type="1">
<li><p>A library of epidemiological parameters extracted from the literature for a range of diseases.</p></li>
<li><p>Functions and classes (with class methods) to work with epidemiological parameters and distributions.</p></li>
</ol>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New features</h2>
<ul>
<li>A library of 122 epidemiological parameter set from the epidemiological literature. This is accessible from the package as system data (<code>sysdata.rda</code>, as <code>epiparameter::multi_epidist</code>) or as internal data (<code>inst/extdata/parameters.json</code>).</li>
<li>The <code>epidist_db()</code> function loads epidemiological parameters from the library.</li>
<li>Distribution parameter conversion and extraction functions (<code>convert_params_to_summary_stats()</code> &amp; <code>convert_summary_stats_to_params()</code>, and <code>extract_param()</code>).</li>
<li>An S3 class to work with epidemiological parameters <code>&lt;epidist&gt;</code>. This class has S3 methods to aid users easily work with these data structures. These include printing, plotting, and distribution functions for PDF/PMF, CDF, random number generation and distribution quantiles. The <code>&lt;epidist&gt;</code> class has a constructor function, a validator function, accessors (<code>get_*()</code>), checkers (<code>is_*()</code>). There is also a <code>&lt;vb_epidist&gt;</code> S3 class for vector-borne parameters, and an internal <code>&lt;multi_epidist&gt;</code> class for improved printing of lists of <code>&lt;epidist&gt;</code> objects.</li>
<li>The package contains a few utility functions. <code>list_distributions()</code> is a helper function to provide information from a list of <code>&lt;epidist&gt;</code> objects in tabular form. <code>calc_disc_dist_quantile()</code> calculates the quantiles of a probability distribution based on the vector of probabilities and time data.</li>
<li>Five vignettes are included in this initial release. One as an introduction to the package (<code>epiparameter.Rmd</code>), one as an tutorial on converting and extracting parameters (<code>extract_convert.Rmd</code>), one on the protocol used to collect entries for the library of epidemiological parameters (<code>data_protocol.Rmd</code>), a design vignette (<code>design_principles.Rmd</code>), and a supplementary vignette which quantifies the bias from using the parameter extraction (<code>extract_param()</code>) from {epiparameter} (<code>extract-bias.Rmd</code>).</li>
<li>Unit tests (98% coverage) and documentation files.</li>
<li>Continuous integration workflows for R package checks, rendering the README.md, calculating test coverage, deploying the pkgdown website, updates the package citation, linting package code, checking package or system dependency changes, updating copyright year, and validating the parameter library JSON file.</li>
</ul>
</section>
<section id="breaking-changes" class="level2">
<h2 class="anchored" data-anchor-id="breaking-changes">Breaking changes</h2>
<ul>
<li>None</li>
</ul>
</section>
<section id="bug-fixes" class="level2">
<h2 class="anchored" data-anchor-id="bug-fixes">Bug fixes</h2>
<ul>
<li>None</li>
</ul>
</section>
<section id="deprecated-and-defunct" class="level2">
<h2 class="anchored" data-anchor-id="deprecated-and-defunct">Deprecated and defunct</h2>
<ul>
<li>None</li>
</ul>
</section>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>Many thanks to the contributors to this release, either from issues, code contributions, reviews or discussions (listed in alphabetical order):</p>
<p><a href="https://github.com/adamkucharski"><span class="citation" data-cites="adamkucharski">@adamkucharski</span></a>, <a href="https://github.com/avallecam"><span class="citation" data-cites="avallecam">@avallecam</span></a>, <a href="https://github.com/Bisaloo"><span class="citation" data-cites="Bisaloo">@Bisaloo</span></a>, <a href="https://github.com/CarmenTamayo"><span class="citation" data-cites="CarmenTamayo">@CarmenTamayo</span></a>, <a href="https://github.com/chartgerink"><span class="citation" data-cites="chartgerink">@chartgerink</span></a>, <a href="https://github.com/jamesmbaazam"><span class="citation" data-cites="jamesmbaazam">@jamesmbaazam</span></a>, <a href="https://github.com/maelle"><span class="citation" data-cites="maelle">@maelle</span></a>, <a href="https://github.com/pratikunterwegs"><span class="citation" data-cites="pratikunterwegs">@pratikunterwegs</span></a>, <a href="https://github.com/pitmonticone"><span class="citation" data-cites="pitmonticone">@pitmonticone</span></a>, <a href="https://github.com/sbfnk"><span class="citation" data-cites="sbfnk">@sbfnk</span></a>, and <a href="https://github.com/TimTaylor"><span class="citation" data-cites="TimTaylor">@TimTaylor</span></a>.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Epiparameter V0.1.0},
  date = {2024-05-30},
  url = {https://epiverse-trace.github.io/posts/epiparameter_v0.1.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Epiparameter
V0.1.0.”</span> May 30, 2024. <a href="https://epiverse-trace.github.io/posts/epiparameter_v0.1.0/">https://epiverse-trace.github.io/posts/epiparameter_v0.1.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/epiparameter_v0.1.0/</guid>
  <pubDate>Thu, 30 May 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>linelist v1.1.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/linelist_v1.1.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new linelist version v1.1.0. Here is an automatically generated summary of the changes in this version.</p>
<section id="breaking-changes" class="level2">
<h2 class="anchored" data-anchor-id="breaking-changes">Breaking changes</h2>
<ul>
<li><p><code>make_linelist()</code> and <code>set_tags()</code> no longer accept a named list of characters as input. Instead, <code>make_linelist()</code>, <code>set_tags()</code> and <code>tags_types()</code> now use <a href="https://rlang.r-lib.org/reference/dyn-dots.html">rlang’s dynamic dots</a>, which means that you can splice list arguments. This implementation is more robust, better tested, and makes it explicit that users want to splice the list (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #96).</p>
<ul>
<li>Before:</li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">my_tags <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"case_ID"</span>,</span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_onset =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"date_of_prodrome"</span>,</span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>,</span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gender"</span></span>
<span id="cb1-6">)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_linelist</span>(obj, my_tags)</span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OR</span></span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_linelist</span>(</span>
<span id="cb1-10">  obj,</span>
<span id="cb1-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"case_ID"</span>,</span>
<span id="cb1-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_onset =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"date_of_prodrome"</span>,</span>
<span id="cb1-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>,</span>
<span id="cb1-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gender"</span></span>
<span id="cb1-15">)</span></code></pre></div>
<ul>
<li>Now:</li>
</ul>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">my_tags <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"case_ID"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_onset =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"date_of_prodrome"</span>,</span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>,</span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gender"</span></span>
<span id="cb2-6">)</span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_linelist</span>(obj, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!!</span>my_tags)</span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OR</span></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_linelist</span>(</span>
<span id="cb2-10">  obj,</span>
<span id="cb2-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"case_ID"</span>,</span>
<span id="cb2-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_onset =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"date_of_prodrome"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>,</span>
<span id="cb2-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gender"</span></span>
<span id="cb2-15">)</span></code></pre></div></li>
</ul>
</section>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New features</h2>
<ul>
<li><p>linelist warnings and errors in the case of a tag loss now have a custom class (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #109), which means it is easier to silence them specifically, or to catch them programmatically for advanced error handling. One example of a new advanced condition handling that was before not possible is:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">warning_counter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">withCallingHandlers</span>({</span>
<span id="cb3-4">  x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> linelist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_linelist</span>(cars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_onset =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dist"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"speed"</span>)</span>
<span id="cb3-5">  x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x[, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb3-6">  x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x[, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is not a linelist warning"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">call. =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb3-8">}, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linelist_warning =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(w) {</span>
<span id="cb3-9">  warning_counter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;&lt;-</span> warning_counter <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-10">})</span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Warning: The following tags have lost their variable:</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  age:speed</span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Warning: The following tags have lost their variable:</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  date_onset:dist</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Warning: This is not a linelist warning</span></span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This pipeline generated "</span>, warning_counter, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" linelist warnings."</span>)</span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Warning: This pipeline generated 2 linelist warnings.</span></span></code></pre></div></li>
<li><p>linelist objects now have a new custom <code>$&lt;-.linelist()</code> to prevent tag loss when subsetting a linelist object (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #86). This completes the functionality already provided by the <code>[&lt;-.linelist()</code> and <code>[[&lt;-.linelist()</code> methods.</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>tagged_column <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Warning in prune_tags(out, lost_action): The following tags have lost their variable:</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  tag:tagged_column</span></span></code></pre></div></li>
<li><p>Validation failures in <code>validate_types()</code> now integrate a delayed error mechanism (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #106). This ensures that the error message will return all the invalid tag types at once rather than having to go through multiple trials and runs.</p>
<ul>
<li>Before: only the first invalid tag type is returned.</li>
</ul>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># No warning about age, even though it also has an invalid type</span></span>
<span id="cb5-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_linelist</span>(cars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"speed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dist"</span>)</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">validate_types</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ref_types =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tags_types</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"factor"</span>))</span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Error in validate_types(x, ref_types = tags_types(age = "factor")) : </span></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   Issue when checking class of tag `gender`:</span></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Must inherit from class 'character'/'factor', but has class 'numeric'</span></span></code></pre></div>
<ul>
<li>Now: the error message returns all the invalid tag types at once.</li>
</ul>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_linelist</span>(cars, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"speed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gender =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dist"</span>)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">validate_types</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ref_types =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tags_types</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"factor"</span>))</span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; Some tags have the wrong class:</span></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   - gender: Must inherit from class 'character'/'factor', but has class 'numeric'</span></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   - age: Must inherit from class 'factor', but has class 'numeric'</span></span></code></pre></div></li>
</ul>
</section>
<section id="internal-changes" class="level2">
<h2 class="anchored" data-anchor-id="internal-changes">Internal changes</h2>
<ul>
<li>Internal duplication in the specification of the tags supported by linelist by default has been removed. This makes it easier to add or remove tags in the future, and reduces the risk of inconsistencies between the different parts of the package (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #111).</li>
<li>The internal <code>tag_variable()</code> function has been replace by a vectorized alternative <code>tag_variable</code>, thus improving performance in <code>make_linelist()</code> and <code>set_tags()</code> about twofold. The error message when tags are specified by position with a number larger than the number of columns in the dataset to tag has also been clarified (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #110).</li>
</ul>
</section>
<section id="documentation" class="level2">
<h2 class="anchored" data-anchor-id="documentation">Documentation</h2>
<ul>
<li>linelist now provides a design vignette for future contributors or maintainers (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #112).</li>
</ul>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Linelist V1.1.0},
  date = {2024-02-28},
  url = {https://epiverse-trace.github.io/posts/linelist_v1.1.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Linelist
V1.1.0.”</span> February 28, 2024. <a href="https://epiverse-trace.github.io/posts/linelist_v1.1.0/">https://epiverse-trace.github.io/posts/linelist_v1.1.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/linelist_v1.1.0/</guid>
  <pubDate>Wed, 28 Feb 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>epidemics v0.1.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/epidemics_v0.1.0/</link>
  <description><![CDATA[ 





<p>We would like to announce the realease on GitHub of version 0.1.0 of <em>epidemics</em>.</p>
<p>This release is aimed at supporting the reproducibility of <a href="https://gaza-projections.org/">analyses in this report</a>, which would be subject to breaking changes due to planned package development.</p>
<p>Please note that this version has not been released to CRAN. <em>epidemics</em> is still being actively developed, with major changes planned for the near future, which will soon supersede this version.</p>
<p><em>epidemics</em> v0.1.0 can be installed using the {pak} package from GitHub using <code>pak::pak("epiverse-trace/epidemics@v0.1.0")</code>.</p>
<p>Here is an automatically generated summary of the changes in this version.</p>
<p>This is an initial GitHub release of <em>epidemics</em>, an R package that ships a library of compartmental epidemic model structures that can be used, along with supplied classes that help define population characteristics and epidemic response interventions including vaccinations, to compose and model epidemic scenarios.</p>
<p>The sections below describe the contents of this release.</p>
<section id="model-structures" class="level2">
<h2 class="anchored" data-anchor-id="model-structures">Model structures</h2>
<p>This release of <em>epidemics</em> includes four model structures supporting a range of composable elements to modify epidemic trajectories.</p>
<ol type="1">
<li><p>“Default” model: A deterministic SEIR-V model allowing heterogeneity in social contacts between demographic groups, with optional, single-dose non-leaky vaccination;</p></li>
<li><p>“Vacamole” model: A deterministic SEI-HRD-V2 implementation of a model allowing heterogeneity in social contacts between demographic groups, with two-dose leaky vaccination (V2), supporting different infection trajectories through the infectious and hospitalised (H) compartments for doubly vaccinated individuals, which tracks deaths (D), and which was initially developed by the Dutch public health agency RIVM for vaccine impact modelling during the Covid-19 pandemic, and published as Ainslie et al.&nbsp;2022 <a href="https://doi.org/10.2807/1560-7917.ES.2022.27.44.2101090" class="uri">https://doi.org/10.2807/1560-7917.ES.2022.27.44.2101090</a>;</p></li>
<li><p>“Diphtheria” model: A deterministic SEIHR model tracking outcomes for different demographic groups, but not including heterogeneity in social contacts, adapted from Finger et al.&nbsp;2019 <a href="https://doi.org/10.1186/s12916-019-1288-7" class="uri">https://doi.org/10.1186/s12916-019-1288-7</a> and intended for application to disease outbreaks in a humanitarian camp setting;</p></li>
<li><p>“Ebola” model: A discrete time stochastic SEIHFR model suitable for modelling Ebola virus disease and other haemorrhagic fevers, and which allows varying the efficacy of isolation in a hospital setting (H), and allows modelling transmission in a funeral context (F), as adapted from a consensus Ebola virus disease model in Li et al.&nbsp;2019 <a href="https://doi.org/10.1098/rspb.2019.0774" class="uri">https://doi.org/10.1098/rspb.2019.0774</a> and using simulation methods from Getz and Dougherty 2018 <a href="https://doi.org/10.1080/17513758.2017.1401677" class="uri">https://doi.org/10.1080/17513758.2017.1401677</a>.</p></li>
</ol>
</section>
<section id="solving-ode-systems-using-boost-odeint" class="level2">
<h2 class="anchored" data-anchor-id="solving-ode-systems-using-boost-odeint">Solving ODE systems using Boost <em>odeint</em></h2>
<p><em>epidemics</em> uses Boost’s <em>odeint</em> <a href="https://www.boost.org/doc/libs/1_84_0/libs/numeric/odeint/doc/html/boost_numeric_odeint/getting_started/overview.html" class="uri">https://www.boost.org/doc/libs/1_84_0/libs/numeric/odeint/doc/html/boost_numeric_odeint/getting_started/overview.html</a> to treat the deterministic models’ ordinary differential equations (ODEs) as initial value problems and solve them.</p>
<p>Model ODEs are defined as <code>structs</code> with operators in the package headers, and exposed to R as internal Rcpp functions. The ‘default’, ‘Vacamole’, and ‘diphtheria’ models are ODE models defined in this way. This is intended to help reduce overheads associated with passing ODE systems written in R back and forth from a solver (such as those provided by {deSolve}), and is an easier way to define feature-rich models than writing C code for solvers provided by {deSolve} that accept compiled code.</p>
<p><em>epidemics</em> headers include tools for handling the C++ representations of R objects used in the package (see below), and can be imported by other Rcpp packages.</p>
<p>The ‘default’ and ‘Vacamole’ models have equivalent R-only implementations as well which use the {deSolve} package; these are intended to be made unavailable in future releases.</p>
</section>
<section id="composable-elements-as-classes" class="level2">
<h2 class="anchored" data-anchor-id="composable-elements-as-classes">Composable elements as classes</h2>
<p><em>epidemics</em> provides classes that help to organise the components of an epidemic scenario model.</p>
<ol type="1">
<li><p><code>&lt;population&gt;</code>: An S3 class to store population characteristics including the size of demographic groups, a social contacts matrix, and initial conditions for a model;</p></li>
<li><p><code>&lt;intervention&gt;</code>: An S3 abstract class and super-class that allows the definition of events that modify the epidemic trajectory:</p>
<ol type="a">
<li><p><code>&lt;rate_intervention&gt;</code>: A sub-class of <code>&lt;intervention&gt;</code> that allows the reduction of transition rates between model compartments to simulate the effect of policy interventions over a specific period;</p></li>
<li><p><code>&lt;contacts_intervention&gt;</code>: A sub-class of <code>&lt;intervention&gt;</code> that allows the reduction of social contacts to simulate the effect of policy interventions over a specific period;</p></li>
</ol></li>
<li><p><code>&lt;vaccination&gt;</code>: An S3 class that holds the intervals and group-specific rates at which individuals transition into the ‘vaccinated’ compartment(s) of a model, if available;</p></li>
</ol>
</section>
<section id="other-composable-elements" class="level2">
<h2 class="anchored" data-anchor-id="other-composable-elements">Other composable elements</h2>
<p><em>epidemics</em> allows models to include elements that affect an epidemic trajectory, but which are not custom classes.</p>
<ol type="1">
<li><p>Time-dependence: All models can be passed a list of functions with two arguments, <code>time</code> and <code>x</code> which are expected to return <code>x</code> as a function of <code>time</code>, and which may be used to model the effect of seasonality in model parameters;</p></li>
<li><p>Population changes: Applicable only to the diphtheria model, a two element list of <code>time</code> and <code>values</code>, which allow the definition of changes to the number of susceptible individuals in the model, and which may be used to model influxes and evacuations of individuals from humanitarian camps.</p></li>
</ol>
</section>
<section id="output-processing-functions" class="level2">
<h2 class="anchored" data-anchor-id="output-processing-functions">Output processing functions</h2>
<p><em>epidemics</em> provides functions to help process the output of an epidemic model run, to calculate the size of the epidemic in each demographic group at any stage (<code>epidemic_size()</code>), and to calculate the number of new infections in each demographic group at each timepoint in the model (<code>new_infections()</code>).</p>
</section>
<section id="usage-vignettes" class="level2">
<h2 class="anchored" data-anchor-id="usage-vignettes">Usage vignettes</h2>
<p><em>epidemics</em> includes a range of usage vignettes that demonstrate how to:</p>
<ol type="1">
<li><p>Get started with the package;</p></li>
<li><p>Get started with modelling interventions on social contacts to control outbreaks;</p></li>
<li><p>Model overlapping and sequential interventions on social contacts;</p></li>
<li><p>Model interventions that modify transition rates between model compartments;</p></li>
<li><p>Get started with modelling a vaccination campaign;</p></li>
<li><p>Model time-dependence and seasonality in disease transmission dynamics;</p></li>
<li><p>Generate and model uncertainty in model parameters;</p></li>
<li><p>Reduce the number of parameters required for final size estimation;</p></li>
<li><p>Use the ‘Vacamole’ model for scenarios of leaky vaccination and vaccine impact on hospitalisation;</p></li>
<li><p>Use the ‘Ebola’ model for scenarios of responses to an Ebola virus disease outbreak;</p></li>
<li><p>Use the ‘diphtheria’ model for scenarios of outbreaks in a humanitarian camp setting.</p></li>
</ol>
</section>
<section id="miscellaneous" class="level2">
<h2 class="anchored" data-anchor-id="miscellaneous">Miscellaneous</h2>
<ol type="1">
<li><p>Workflows to render the vignettes and README as a website;</p></li>
<li><p>Test code coverage of 93%.</p></li>
</ol>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Epidemics V0.1.0},
  date = {2024-02-27},
  url = {https://epiverse-trace.github.io/posts/epidemics_v0.1.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Epidemics
V0.1.0.”</span> February 27, 2024. <a href="https://epiverse-trace.github.io/posts/epidemics_v0.1.0/">https://epiverse-trace.github.io/posts/epidemics_v0.1.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/epidemics_v0.1.0/</guid>
  <pubDate>Tue, 27 Feb 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>simulist v0.2.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/simulist_v0.2.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new simulist version v0.2.0. Here is an automatically generated summary of the changes in this version.</p>
<p>Second release of <em>simulist</em>, updates the core simulation model and, as a result, the arguments for <code>sim_*()</code> functions for simulating line list data and/or contact table data exported from <em>simulist</em> are updated. The internal package architecture is also refactored.</p>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New features</h2>
<section id="external" class="level3">
<h3 class="anchored" data-anchor-id="external">External</h3>
<ul>
<li><code>create_config()</code> now returns a new element in the list: <code>$network</code>. By default <code>create_config()</code> returns <code>network = "adjusted"</code>, which assumes the simulation is a random network and samples contacts with an excess degree distribution (see Details in <code>?create_config()</code>). The network effect can be changed to <code>"unadjusted"</code> to <em>switch off</em> the network effect. <code>$network</code> is checked internally (in <code>.sim_network_bp()</code>) and will error if not valid (#60).</li>
<li>Package architecture diagram is added to <code>design-principles.Rmd</code> (#66).</li>
<li>lintr GitHub action workflow (<code>lint-changed-files.yaml</code>) is added to the suite of continuous integration workflows (#68).</li>
<li>Transmission chain visualisation is added to <code>vis-linelist.Rmd</code> (#70).</li>
</ul>
</section>
<section id="internal" class="level3">
<h3 class="anchored" data-anchor-id="internal">Internal</h3>
<ul>
<li><code>.sim_network_bp()</code> is added as an internal function and replaces <code>bpmodels::chain_sim()</code> as the core simulation model producing contacted and infected individuals. <code>{bpmodels}</code> is removed as a dependency as a result (#60).</li>
<li><code>.sample_names()</code> is added as an internal function to utilise <code>randomNames::randomNames()</code> to produce more unique names than <code>randomNames(..., sample.with.replacement = FALSE)</code>.</li>
<li>Refactor of internal simulation architecture replaced <code>.sim_bp_linelist()</code>, <code>.sim_clinical_linelist()</code> and <code>.sim_contacts_tbl()</code> with <code>.sim_internal()</code> (#66).</li>
<li>The <code>sim_utils.R</code> file was renamed to <code>utils.R</code> (#66) and the empty <code>create_linelist.R</code> file was removed (#72).</li>
<li><code>.add_date_contact()</code> argument <code>outbreak_start_date</code> is now <code>NULL</code> by default instead of missing (#82).</li>
<li>Regression tests of <code>sim_*()</code> functions now use <a href="https://testthat.r-lib.org/articles/snapshotting.html">snapshot testing</a> for more detailed data checking (#65).</li>
<li>Internal testing data (<code>testdata</code>) files have been updated, as has the <code>testdata/README.md</code> with instructions (#64).</li>
</ul>
</section>
</section>
<section id="breaking-changes" class="level2">
<h2 class="anchored" data-anchor-id="breaking-changes">Breaking changes</h2>
<ul>
<li><code>R</code> and <code>serial_interval</code> arguments have been removed from <code>sim_linelist()</code>, <code>sim_contacts()</code> and <code>sim_outbreak()</code> functions and instead <code>contact_distribution</code>, <code>contact_interval</code> and <code>prob_infect</code> are used to parameterise the simulation. Documentation, both functions and vignettes, have been updated with these changes (#60).</li>
<li>The <code>contact_distribution</code> argument in <code>sim_*()</code> functions requires a density function if supplied as an anonymous function. Information is added to <code>simulist.Rmd</code> to explain this.</li>
<li>The line list output from <code>sim_linelist()</code> now uses column header <code>sex</code> instead of <code>gender</code>. The contacts table output from <code>sim_contacts()</code> and <code>sim_outbreak()</code> now uses column headers <code>age</code> and <code>sex</code> instead of <code>cnt_age</code> and <code>cnt_gender</code> (#60, #79).</li>
<li><code>contact_distribution</code> is redefined and redocumented as the distribution of contacts per individual, rather than the number of contacts that do not get infected as it was in v0.1.0.</li>
<li><code>row.names</code> for <code>&lt;data.frame&gt;</code>s output by <code>sim_linelist()</code>, <code>sim_contacts()</code> and <code>sim_outbreak()</code> are now sequential from <code>1:nrows</code> (#63).</li>
</ul>
</section>
<section id="bug-fixes" class="level2">
<h2 class="anchored" data-anchor-id="bug-fixes">Bug fixes</h2>
<ul>
<li><code>sim_contacts()</code> now correctly runs with an age-structured population. In the previous version (v0.1.0), <code>sim_contacts()</code> did not call <code>.check_age_df()</code> and as a result the function errored, this is fixed as of PR #81.</li>
</ul>
</section>
<section id="deprecated-and-defunct" class="level2">
<h2 class="anchored" data-anchor-id="deprecated-and-defunct">Deprecated and defunct</h2>
<ul>
<li>None</li>
</ul>
</section>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>Many thanks to the contributors to this release, either from issues, code contributions, reviews or discussions (listed in alphabetical order):</p>
<p><a href="https://github.com/adamkucharski"><span class="citation" data-cites="adamkucharski">@adamkucharski</span></a>, <a href="https://github.com/avallecam"><span class="citation" data-cites="avallecam">@avallecam</span></a>, <a href="https://github.com/Bisaloo"><span class="citation" data-cites="Bisaloo">@Bisaloo</span></a>, <a href="https://github.com/chartgerink"><span class="citation" data-cites="chartgerink">@chartgerink</span></a>, <a href="https://github.com/jamesmbaazam"><span class="citation" data-cites="jamesmbaazam">@jamesmbaazam</span></a>, <a href="https://github.com/pratikunterwegs"><span class="citation" data-cites="pratikunterwegs">@pratikunterwegs</span></a>, and <a href="https://github.com/sbfnk"><span class="citation" data-cites="sbfnk">@sbfnk</span></a>.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Simulist V0.2.0},
  date = {2024-02-23},
  url = {https://epiverse-trace.github.io/posts/simulist_v0.2.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Simulist
V0.2.0.”</span> February 23, 2024. <a href="https://epiverse-trace.github.io/posts/simulist_v0.2.0/">https://epiverse-trace.github.io/posts/simulist_v0.2.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/simulist_v0.2.0/</guid>
  <pubDate>Fri, 23 Feb 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>New team member: Chris Hartgerink</title>
  <dc:creator>Chris Hartgerink</dc:creator>
  <link>https://epiverse-trace.github.io/posts/chjh-intro-blog/</link>
  <description><![CDATA[ 





<p>In January, I joined Epiverse as part of my new role as Senior Software Engineer at <a href="https://data.org">data.org</a>. In the weeks since, I have been able to already meet a lot of members of the Epiverse community. Talking to you and hearing about what drives you, further excites me to be part of this community! In order to build on that and keep the energy flowing, I wanted to introduce myself here more broadly.</p>
<p>In this blog post, I share some of my background in R, my interest in open source, and how I look to contribute to this community. I want to already highlight that I love finishing things, from peanut butter jars to pull requests — so if you have anything that you’d like to pull over the finish line, I am more than happy to support in doing that!</p>
<section id="background-in-r" class="level2">
<h2 class="anchored" data-anchor-id="background-in-r">Background in R</h2>
<p>My first real introduction to programming was with R back in 2013, during a course on statistical programming. This was more about scripting than engineering, but it was where I dipped my toes. During my PhD at <a href="https://www.tilburguniversity.edu/about/schools/socialsciences/organization/departments/methodology-statistics">a methodology and statistics department</a>, I ended up becoming the go to person for getting mundane things done faster. I ended up writing R and shell scripts left and right, with most of them ending up being used only once. <a href="https://xkcd.com/1319">I wasted a lot of time</a> and had tons of fun doing this! I ended up writing scripts for my research as well, leading to some legal troubles with big publishers (<a href="https://www.chjh.nl/elsevier-stopped-me-doing-my-research/">see this old blog post</a>). Oops!</p>
<p>From scripting came contributing to R packages like <a href="https://cran.r-project.org/web/packages/statcheck/index.html"><code>statcheck</code></a>, from which came developing my own packages like <a href="https://cran.r-project.org/web/packages/retractcheck/index.html"><code>retractcheck</code></a>. Before I knew it I was helping others learn R and build their own packages in small workshops. This was back when the <code>devtools</code> experience was pretty decent but in no way as complete as it is today.</p>
<p>Around 2018, <a href="https://www.chjh.nl/reflections-on-my-phd/">I ended up leaving academia</a> and stopped needing to develop in R. I was not upset because R development is rather quirky and arbitrary at times. Since then, I have designed, built, and maintained production web applications in NodeJS, with my biggest achievement being <a href="https://www.researchequals.com">ResearchEquals</a>. I’m excited to bring the best of different languages together in this new position. Coming from NodeJS engineering, I already see some avenues for building a better developer experience in R. I look forward to not just contribute packages but also more general tooling during my time working on Epiverse.</p>
</section>
<section id="working-openly" class="level2">
<h2 class="anchored" data-anchor-id="working-openly">Working openly</h2>
<p>I come to open source through open science, which is all about reducing the “insiders” and “outsiders” of research. Can people access publications equitably? Can people contribute to the work that’s happening equitably? Are funds distributed equitably? There are still big barriers to accessing research, its institutions, and as a result there remain inequities in the knowledge that is produced.</p>
<p>As a natural extension of open science, I started getting involved with open source communities around 2015-2016. I started with smaller open source projects springboarding to bigger projects over time. I documented all my own research projects on GitHub and started building websites (e.g., one about <a href="https://libscie.github.io/libcopy/">copyright in research publishing</a>). All this practice developed my philosophy of working openly, which culminated in my time as a Mozilla Open Science Fellow in 2017.</p>
<p>With over a decade of practice, I approach <a href="https://wiki.mozilla.org/Working_open#Open_vs._Transparent">working openly</a> as community work. Open source is not just making information public - it requires making that information accessible and actionable. It has to be public <strong>and</strong> participatory. It needs to be informed by the needs of those participating, and participation needs to be encouraged, enabled, and scaffolded. This also means that the community needs to define what it desires. Are we working on a static piece of information that we want to enable reuse of (e.g., a finalized dataset) or do we want to co-create with people who we still need to invite in? People come and go, and so this community culture has to evolve.</p>
<p>Working openly, to me, also means that considerate and empathetic communication is key. It requires articulating our own needs, wants, and uncertainty with honesty. It requires accepting that our personal wants are not always aligned with what the community wants. How do we deal with those situations? Do we seek consensus or majorities? These discussions need humility and not getting entitled to things. It means actually listening to each other. There is no room for peacockery or posturing, but lots of room for caring and celebrating each other.</p>
</section>
<section id="contributing-to-epiverse" class="level2">
<h2 class="anchored" data-anchor-id="contributing-to-epiverse">Contributing to Epiverse</h2>
<p>I am excited to bring this philosophy of working open to Epiverse and vice versa, learn how this community is open in its own unique way. With an international community across three continents there are important questions around what it means to be participatory. After talking to various community members, it is clear this community raises important and practical questions. I am also intrigued to see what is preventing people from joining this community - what barriers are we unconsciously putting up?</p>
<p>I see my role within Epiverse as a <a href="https://en.wikipedia.org/wiki/Rush_goalie">“rush goalie”</a> (also known as a fly goalie). I will own the development and maintainance of specific pieces of software, yet I can leave those to actively support work throughout Epiverse. In short: I go where I am needed, in whatever form that may be. That can be software development, community engagement, and so much more.</p>
<p>To that end: Get in touch with me anytime you think I might be of support. Tag me on GitHub liberally (<code>@chartgerink</code>). Send me emails on <a href="mailto:chris@data.org" class="email">chris@data.org</a>. DM me wherever. I am here to support Epiverse and all its various packages in whatever shape they may need. This includes code reviews, making fixes, and being part of discussions. I would rather be tagged once too often than once too little.</p>
<p>Epiverse is also not a standalone community within the R space, so when practical, I will also contribute back to the packages that we use in our work. I already started making pull requests elsewhere, and it is great to see the R community be so welcoming to outside contributions. My hope is that Epiverse will be just as welcoming and a part of that wider ecosystem.</p>
<hr>
<p>At the moment, I am still finding my way throughout the various repositories. It takes time to understand new code and start identifying areas to contribute (and it’s not always as easy as can be). I will be checking in on the repositories (and there are a lot!) and may ask around to see whether PRs or issues are still relevant. Nonetheless, after several weeks, I am starting to feel more like a part of the community than a newbie.</p>
<p>Thanks for reading along and feel free to leave a comment if you have anything else you’d like to know.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Getting in touch
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can reach me on <a href="mailto:chris@data.org" class="email">chris@data.org</a> or on GitHub under <a href="https://github.com/chartgerink"><span class="citation" data-cites="chartgerink">@chartgerink</span></a>. I am also on Mastodon under <a href="https://akademienl.social/@chartgerink"><span class="citation" data-cites="chartgerink">@chartgerink</span><span class="citation" data-cites="akademienl.social">@akademienl.social</span></a>.</p>
</div>
</div>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{hartgerink2024,
  author = {Hartgerink, Chris},
  title = {New Team Member: {Chris} {Hartgerink}},
  date = {2024-02-15},
  url = {https://epiverse-trace.github.io/posts/chjh-intro-blog/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-hartgerink2024" class="csl-entry quarto-appendix-citeas">
Hartgerink, Chris. 2024. <span>“New Team Member: Chris
Hartgerink.”</span> February 15, 2024. <a href="https://epiverse-trace.github.io/posts/chjh-intro-blog/">https://epiverse-trace.github.io/posts/chjh-intro-blog/</a>.
</div></div></section></div> ]]></description>
  <category>Team</category>
  <guid>https://epiverse-trace.github.io/posts/chjh-intro-blog/</guid>
  <pubDate>Thu, 15 Feb 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Things that can go wrong when using renv</title>
  <dc:creator>Hugo Gruson</dc:creator>
  <link>https://epiverse-trace.github.io/posts/renv-complications/</link>
  <description><![CDATA[ 





<p>Throughout the Epiverse project, we use the <a href="https://rstudio.github.io/renv/">renv R package</a> to ensure reproducibility of the training materials and the pipelines we are providing. But we sometimes get reports from users who struggle to rebuild the environment and run the code.</p>
<p>In this post, we dissect the source of these issues, explain why in reality renv is not at fault, and how this is caused by the inherent complexity of reproducibility. The renv documentation already includes <a href="https://rstudio.github.io/renv/articles/renv.html#caveats">caveats</a> explaining why some situations are bound to require more complex tools. This blog post reiterates some of these caveats and illustrates them with concrete examples.</p>
<p>Finally, we mention a couple of more complete (but more complex!) frameworks that can overcome the issues presented here. We do not explore these alternative framework in detail but provide links to more information.</p>
<section id="binaries-vs-building-from-source" class="level2">
<h2 class="anchored" data-anchor-id="binaries-vs-building-from-source">Binaries vs building from source</h2>
<p>Software, including R packages, can generally be delivered in two forms: as binaries or as source code. If you are building from the source code, you may in some case need a compilation toolchain on your computer. If that toolchain is missing, it can lead to errors such as:</p>
<blockquote class="blockquote">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb1-1">ld: warning: search path '/opt/gfortran/lib' not found</span>
<span id="cb1-2">ld: library 'gfortran' not found</span></code></pre></div>
</blockquote>
<p>Most of the time, regular users of R will not see these errors because they are installing binaries. Indeed, CRAN provides pre-compiled binaries for Windows and macOS for the last version of the package and R.</p>
<p>With renv, you often want to install older versions of the packages, which won’t be available as binaries from CRAN. This means you are more likely to have to compile the package yourself and see this kind of errors, even though renv is not causing them.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
gfortran issues on Apple Silicon computers
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you are an Apple Silicon (Mac M1, M2, M3) user and encounter issues with gfortran, we have had success using the <a href="https://github.com/coatless-mac/macrtools/">macrtools R package</a> and we strongly recommend checking it out.</p>
</div>
</div>
</section>
<section id="beyond-renv-scope-incompatibility-with-system-dependency-versions" class="level2">
<h2 class="anchored" data-anchor-id="beyond-renv-scope-incompatibility-with-system-dependency-versions">Beyond renv scope: incompatibility with system dependency versions</h2>
<p>We <a href="../system-dependencies/">discussed previously the topic of system dependencies</a>, and <a href="https://blog.r-hub.io/2022/09/12/r-dependency/">dependencies on specific R versions</a>. These special dependencies can also be a source of headaches when using renv.</p>
<p>The heart of the issue is that renv provides a simplified solution to reproducibility: it focuses on R packages and their versions. But other sources of non-reproducibility are outside its scope. In many cases, this will not be a problem, as the main source of non-reproducibility, especially in the relatively short-term, will be R package versions.</p>
<p>But sometimes, it is possible that the <code>renv.lock</code> lockfile requires such an old version of an R package that it was written with a syntax that is no longer supported by recent R versions or modern compilers.</p>
<p>For example, a recent project (from 2023) was trying to install the version 0.60.1 of the <code>matrixStats</code> package (from 2021). This lead to this compilation error:</p>
<blockquote class="blockquote">
<p>error: ‘DOUBLE_XMAX’ undeclared (first use in this function); did you mean ‘DBL_MAX’?</p>
</blockquote>
<details>
<summary>
Click to see the full error message
</summary>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb2-1">! Error installing package 'matrixStats':</span>
<span id="cb2-2">=======================================</span>
<span id="cb2-3"></span>
<span id="cb2-4">* installing *source* package ‘matrixStats’ ...</span>
<span id="cb2-5">** package ‘matrixStats’ successfully unpacked and MD5 sums checked</span>
<span id="cb2-6">** using staged installation</span>
<span id="cb2-7">** libs</span>
<span id="cb2-8">using C compiler: ‘gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0’</span>
<span id="cb2-9">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c 000.init.c -o 000.init.o</span>
<span id="cb2-10">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c allocMatrix2.c -o allocMatrix2.o</span>
<span id="cb2-11">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c anyMissing.c -o anyMissing.o</span>
<span id="cb2-12">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c binCounts.c -o binCounts.o</span>
<span id="cb2-13">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c binMeans.c -o binMeans.o</span>
<span id="cb2-14">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c colCounts.c -o colCounts.o</span>
<span id="cb2-15">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c colOrderStats.c -o colOrderStats.o</span>
<span id="cb2-16">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c colRanges.c -o colRanges.o</span>
<span id="cb2-17">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c diff2.c -o diff2.o</span>
<span id="cb2-18">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c indexByRow.c -o indexByRow.o</span>
<span id="cb2-19">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c logSumExp.c -o logSumExp.o</span>
<span id="cb2-20">gcc -I"/usr/share/R/include" -DNDEBUG       -fpic  -g -O2 -ffile-prefix-map=/build/r-base-H0vbME/r-base-4.3.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2  -c mean2.c -o mean2.o</span>
<span id="cb2-21">In file included from mean2_lowlevel.h:14,</span>
<span id="cb2-22">                 from mean2.c:9:</span>
<span id="cb2-23">mean2_lowlevel_template.h: In function ‘mean2_int’:</span>
<span id="cb2-24">mean2_lowlevel_template.h:59:13: error: ‘DOUBLE_XMAX’ undeclared (first use in this function); did you mean ‘DBL_MAX’?</span>
<span id="cb2-25">   59 |   if (sum &gt; DOUBLE_XMAX) {</span>
<span id="cb2-26">      |             ^~~~~~~~~~~</span>
<span id="cb2-27">      |             DBL_MAX</span>
<span id="cb2-28">mean2_lowlevel_template.h:59:13: note: each undeclared identifier is reported only once for each function it appears in</span>
<span id="cb2-29">In file included from mean2_lowlevel.h:18,</span>
<span id="cb2-30">                 from mean2.c:9:</span>
<span id="cb2-31">mean2_lowlevel_template.h: In function ‘mean2_dbl’:</span>
<span id="cb2-32">mean2_lowlevel_template.h:59:13: error: ‘DOUBLE_XMAX’ undeclared (first use in this function); did you mean ‘DBL_MAX’?</span>
<span id="cb2-33">   59 |   if (sum &gt; DOUBLE_XMAX) {</span>
<span id="cb2-34">      |             ^~~~~~~~~~~</span>
<span id="cb2-35">      |             DBL_MAX</span>
<span id="cb2-36">make: *** [/usr/lib/R/etc/Makeconf:191: mean2.o] Error 1</span>
<span id="cb2-37">ERROR: compilation failed for package ‘matrixStats’</span></code></pre></div>
</details>
<p>The explanation for this error can be found in <a href="https://github.com/HenrikBengtsson/matrixStats/blob/799669fc6de6f55a74cab06cc6a97634aa24ab0e/NEWS.md?plain=1#L111-L113">the <code>matrixStats</code> release notes</a>, specifically the section for matrixStats 0.63.0:</p>
<blockquote class="blockquote">
<ul>
<li>Updated native code to use the C99 constant <code>DBL_MAX</code> instead of legacy S constant <code>DOUBLE_XMAX</code>, which is planned to be unsupported in R (&gt;= 4.2.0).</li>
</ul>
</blockquote>
</section>
<section id="some-solutions" class="level2">
<h2 class="anchored" data-anchor-id="some-solutions">Some solutions</h2>
<section id="alternative-package-managers" class="level3">
<h3 class="anchored" data-anchor-id="alternative-package-managers">Alternative package managers</h3>
<p>We discussed how many issues when using renv can arise during the package compilation from source. A potential solution would be to avoid this compilation step and always install pre-compiled binaries.</p>
<p>This is not possible while installing from CRAN as CRAN only provides binaries for recent versions of R and for a limited number of platforms.</p>
<p>But Posit for example provides a larger collection of binaries, for different package versions, and different platforms, via their Public <a href="https://packagemanager.posit.co/">Posit Package Manager (PPM)</a>.</p>
<p>Making sure you install from PPM rather than CRAN can be a first simple step to make some of the issues discussed here vanish.</p>
</section>
<section id="extending-the-scope-of-reproducibility" class="level3">
<h3 class="anchored" data-anchor-id="extending-the-scope-of-reproducibility">Extending the scope of reproducibility</h3>
<p>Another solution could be to add more complex reproducibility solutions that go beyond the scope of renv.</p>
<section id="renv-with-rig" class="level4">
<h4 class="anchored" data-anchor-id="renv-with-rig">renv with rig</h4>
<p>The R version is specified in <code>renv.lock</code> and to avoid incompatibility of older package versions with newer versions of R, you could run the declared R version. This can be achieved with various means but a convenient solution is the <a href="https://github.com/r-lib/rig">rig</a> tool.</p>
<p>There are even some <a href="https://github.com/r-lib/rig/issues/131">discussions</a> to integrate rig and renv more tightly and let rig detect automatically which R version to use based on the <code>renv.lock</code> file.</p>
</section>
<section id="docker-nix-and-others" class="level4">
<h4 class="anchored" data-anchor-id="docker-nix-and-others">Docker, Nix and others</h4>
<p>Alternatively, you could use other reproducibility toolkits that focus not just on the R package versions, but on the entire software stack (e.g., including the operating system, the system dependencies). These solutions can be more complex to set up and use, and we won’t detail them in this blog post but you can find more information in:</p>
<ul>
<li><a href="https://rstudio.github.io/renv/articles/docker.html">The “Using renv with Docker” renv vignette</a></li>
<li><a href="https://doi.org/10.32614/RJ-2017-065">the “An Introduction to Rocker: Docker Containers for R” paper</a></li>
<li><a href="https://www.brodrigues.co/blog/2023-07-13-nix_for_r_part1/">Bruno Rodrigues’ entire series of blog posts on Nix</a></li>
</ul>
</section>
</section>
<section id="conclusion-a-final-note-for-developers" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-a-final-note-for-developers">Conclusion: a final note for developers</h3>
<p>renv is an elegant solution that focuses on the most immediate source of non-reproducibility. This however means it needs to be complemented by other tools in more complex cases.</p>
<p>Ultimately, reproducibility is a team effort. People who write code can minimise the risk of renv complications by keeping the packages they use close to their CRAN version and regularly updating their code and <code>renv.lock</code> accordingly. Other programming languages have automated tooling to help with this, via, e.g., the <a href="https://github.blog/2020-06-01-keep-all-your-packages-up-to-date-with-dependabot/">dependabot tool</a> which submits pull requests to update dependencies. There is no well established equivalent for R yet, but anyone willing to set this mechanism up can look at the code used by the <a href="https://github.com/carpentries/actions/tree/70ff4b4e8d50fdcd0eb33e7c33a4a6f305a82702/update-lockfile">Carpentries workbench</a> for this task.</p>
<p><em>Thanks to Pratik Gupte and Chris Hartgerink for their valuable comments on earlier drafts of this post.</em></p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{gruson2024,
  author = {Gruson, Hugo},
  title = {Things That Can Go Wrong When Using Renv},
  date = {2024-01-31},
  url = {https://epiverse-trace.github.io/posts/renv-complications/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-gruson2024" class="csl-entry quarto-appendix-citeas">
Gruson, Hugo. 2024. <span>“Things That Can Go Wrong When Using
Renv.”</span> January 31, 2024. <a href="https://epiverse-trace.github.io/posts/renv-complications/">https://epiverse-trace.github.io/posts/renv-complications/</a>.
</div></div></section></div> ]]></description>
  <category>R</category>
  <category>reproducibility</category>
  <category>renv</category>
  <guid>https://epiverse-trace.github.io/posts/renv-complications/</guid>
  <pubDate>Wed, 31 Jan 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>superspreading v0.2.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/superspreading_v0.2.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new superspreading version v0.2.0. Here is an automatically generated summary of the changes in this version.</p>
<p>Second minor release of <em>superspreading</em>. This release enhances functions added in v0.1.0 and adds two new exported functions, and two new vignettes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(superspreading)</span></code></pre></div>
</div>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New features</h2>
<ul>
<li>A new function (<code>calc_network_R()</code>) to estimate the reproduction number for heterogeneous networks and a vignette outlining use cases for the function from existing epidemiological literature is added (#71).</li>
<li><code>probability_epidemic()</code> and <code>probability_extinct()</code> now have individual-level and population-level control in a joint framework (#70).</li>
<li><code>proportion_*()</code> functions can now return proportion columns of the output <code>&lt;data.frame&gt;</code> as <code>numeric</code> when the new argument <code>format_prop</code> is set to <code>FALSE</code> (#72).</li>
<li>A new design principles vignette to document package development is added (#68).</li>
<li>Added a helper function (<code>ic_tbl()</code>) to improve model comparison tables (#65).</li>
<li><code>probability_*()</code> functions now accept <a href="https://rlang.r-lib.org/reference/dyn-dots.html">dynamic dots</a> (<a href="https://CRAN.R-project.org/package=rlang">{rlang}</a> is added as a dependency) (#82).</li>
</ul>
</section>
<section id="breaking-changes" class="level2">
<h2 class="anchored" data-anchor-id="breaking-changes">Breaking changes</h2>
<ul>
<li><code>ind_control</code> and <code>pop_control</code> arguments replace <code>control</code> and <code>control_type</code> arguments in <code>probability_contain()</code>; and the argument default for <code>num_init_infect</code> is removed (#70).</li>
<li>Changed <code>epidist</code> argument to <code>offspring_dist</code> to follow Epiverse style (affects several functions) (#64).</li>
<li>Argument in <code>proportion_transmission()</code> has been renamed from <code>sim</code> to <code>simulate</code> (#81).</li>
</ul>
</section>
<section id="minor-changes" class="level2">
<h2 class="anchored" data-anchor-id="minor-changes">Minor changes</h2>
<ul>
<li>New package hex logo (#73).</li>
<li>Updated continuous integration and package infrastructure (#67).</li>
<li>Improved function documentation (#63).</li>
<li>Optimisation now uses <code>optim()</code> by default (#82).</li>
<li>Testing suite now uses snapshot testing for regression tests (#84).</li>
</ul>
</section>
<section id="bug-fixes" class="level2">
<h2 class="anchored" data-anchor-id="bug-fixes">Bug fixes</h2>
<ul>
<li>None to {superspreading} functions.</li>
<li>Update {epiparameter} use in vignette and tests (#62).</li>
</ul>
</section>
<section id="deprecated-and-defunct" class="level2">
<h2 class="anchored" data-anchor-id="deprecated-and-defunct">Deprecated and defunct</h2>
<ul>
<li>None</li>
</ul>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Superspreading V0.2.0},
  date = {2024-01-29},
  url = {https://epiverse-trace.github.io/posts/superspreading_v0.2.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Superspreading
V0.2.0.”</span> January 29, 2024. <a href="https://epiverse-trace.github.io/posts/superspreading_v0.2.0/">https://epiverse-trace.github.io/posts/superspreading_v0.2.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/superspreading_v0.2.0/</guid>
  <pubDate>Mon, 29 Jan 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>simulist v0.1.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/simulist_v0.1.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new simulist version v0.1.0. Here is an automatically generated summary of the changes in this version.</p>
<p>Initial release of <em>simulist</em>, an R package containing tools to simulate epidemiological data such as line lists and contact tables.</p>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New features</h2>
<ul>
<li>A set of simulation functions to simulate epidemiological data. These simulation functions contain arguments that allow for the simulation to be flexibly parameterised to be generated under specified epidemiological or demographic conditions.
<ul>
<li><code>sim_linelist()</code>: simulate line list data</li>
<li><code>sim_contacts()</code>: simulate contacts data</li>
<li><code>sim_outbreak()</code>: simulate both line list and contacts data</li>
</ul></li>
<li>Four general vignettes
<ul>
<li>Get Started vignette (<code>simulist.Rmd</code>)</li>
<li>Age-stratified hospitalisation and death risks vignette (<code>age-strat-risks.Rmd</code>)</li>
<li>Age structured population vignette (<code>age-struct-pop.Rmd</code>)</li>
<li>Visualising simulated data (<code>vis-linelist.Rmd</code>)</li>
</ul></li>
<li>One developer focused vignette
<ul>
<li>Design Principles for {simulist} (<code>design-principles.Rmd</code>)</li>
</ul></li>
<li>Unit tests (100% code coverage) and documentation files.</li>
<li>Continuous integration workflows for R package checks, rendering the README.md, calculating test coverage, deploying the pkgdown website, updating the citation file, and checking new package or system dependencies.</li>
</ul>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2024,
  author = {Epiverse-TRACE development team, The},
  title = {Simulist V0.1.0},
  date = {2024-01-09},
  url = {https://epiverse-trace.github.io/posts/simulist_v0.1.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2024" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2024. <span>“Simulist
V0.1.0.”</span> January 9, 2024. <a href="https://epiverse-trace.github.io/posts/simulist_v0.1.0/">https://epiverse-trace.github.io/posts/simulist_v0.1.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/simulist_v0.1.0/</guid>
  <pubDate>Tue, 09 Jan 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>cfr v0.1.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/cfr_v0.1.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new cfr version v0.1.0. Here is an automatically generated summary of the changes in this version.</p>
<p>Initial CRAN submission of <em>cfr</em>, an R package to estimate the severity of a disease and ascertainment of cases while correcting for delays in outcomes of reported cases being known.</p>
<p>This release includes:</p>
<ol type="1">
<li>Functions for the overall severity of an outbreak, the overall severity of an outbreak estimated with an expanding time series of data, and the time-varying severity of an outbreak,</li>
<li>A function to estimate the number of outcomes to be expected from a given number of cases assuming a user-specified distribution of delays between cases and outcomes being known,</li>
<li>A function to estimate the overall (static) ascertainment of cases in an outbreak by comparing the relevant severity measures against a user-specified baseline severity (note that functionality for time-varying ascertainment is expected to be included in future versions, and an older implementation of this functionality was removed just prior to release),</li>
<li>A data preparation generic with an S3 method for the <code>&lt;incidence2&gt;</code> class from the <em>incidence2</em> package,</li>
<li>Example daily case and death data from the 1976 Ebola Virus Disease outbreak as reported in Camacho et al.&nbsp;(2014). <a href="https://doi.org/10.1016/j.epidem.2014.09.003" class="uri">https://doi.org/10.1016/j.epidem.2014.09.003</a>,</li>
<li>Example daily case and death data from the Covid-19 pandemic over the range 2020-01-01 to 2022-12-31 from the 19 countries with over 100,00 deaths over this period, as taken from the <em>covidregionaldata</em> package which is no longer on CRAN,</li>
<li>Vignettes describing how to get started with severity estimation, and more detailed workflows on different kinds of severity estimation,</li>
<li>A vignette on working with data from the <em>incidence2</em> package, and a vignette on working with delay distributions,</li>
<li>100% code coverage,</li>
<li>Workflows to render the vignettes and README as a website.</li>
</ol>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2023,
  author = {Epiverse-TRACE development team, The},
  title = {Cfr V0.1.0},
  date = {2023-11-22},
  url = {https://epiverse-trace.github.io/posts/cfr_v0.1.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2023" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2023. <span>“Cfr V0.1.0.”</span>
November 22, 2023. <a href="https://epiverse-trace.github.io/posts/cfr_v0.1.0/">https://epiverse-trace.github.io/posts/cfr_v0.1.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/cfr_v0.1.0/</guid>
  <pubDate>Wed, 22 Nov 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Using benchmarking to guide the adoption of dependencies in R packages</title>
  <dc:creator>James Mba Azam</dc:creator>
  <link>https://epiverse-trace.github.io/posts/benchmarking_design_decisions/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(bench)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(cli)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span></code></pre></div>
</div>
<p>R package developers often have to take on dependencies for various reasons. Dependencies are external packages that provide extra functionalities or features to another package <span class="citation" data-cites="wickham2023r">(Wickham and Bryan 2023)</span>. Quite often, the goal of taking on a dependency is to utilize its rich features and reduce duplicated coding effort. For example, the <code>ggplot2</code> package is often adopted, instead of R’s inbuilt plotting functions, to make visualizations using its declarative system and implementation of the Grammar of Graphics, and slick automation across the board.</p>
<p>Sometimes, introducing a dependency might slow down existing processes. Hence, it is important to consider the speed of a dependency’s functions before adopting it. Code optimisation is often reserved for heavy processes like data processing steps. However, here, we will focus on lesser optimised processes, and in particular, printing of texts in R.</p>
<p>For this demonstration, we will look at a situation where a package developer is considering options for condition signalling beyond the functionalities provided in base R. Condition signalling refers to the process of communicating to a user that an issue has arisen during code execution <span class="citation" data-cites="wickham2019advanced">(Wickham 2019)</span>.</p>
<p>Base R ships with functionalities for condition signalling. There is <code>base::stop()</code> for signalling errors. Errors refer to cases where something fatal happens during code execution so that it halts, for example, when a function is run without specifying the required arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>()</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in rnorm(): argument "n" is missing, with no default</code></pre>
</div>
</div>
<p>Base R provides <code>base::warning()</code> for throwing warnings. Warnings are used to handle less fatal issues with code execution that do not need to halt the process. For example, when you compare two vectors of different lengths, R will throw a warning but will still return a result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in c(1:2) &gt; c(1:3): longer object length is not a multiple of shorter
object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>Lastly, there is <code>base::message()</code> for throwing messages. Messages are used to provide useful information about processes. For example, packages throw messages about NAMESPACE conflicts when loaded. This is to inform the user so they know what next steps to take.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(data.table)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, first, last</code></pre>
</div>
</div>
<p>These base R functions are, however, not flexible enough for advanced formatting: colour, progress bar, contextual pluralisation, and so forth. The package developer might want to adopt external dependencies for these flexibilities. The <a href="https://cli.r-lib.org/articles/semantic-cli.html">cli</a> package is well designed for this. <code>cli</code> offers many of the advanced formatting features. Here is a quick example (adopted from the help file) using <code>cli::cli_abort()</code>, the equivalent of <code>base::stop()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c(1, 2, 3)"</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cli_abort</span>(</span>
<span id="cb10-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb10-4">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{.var n} must be a numeric vector"</span>,</span>
<span id="cb10-5">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You've supplied a {.cls {class(n)}} vector."</span></span>
<span id="cb10-6">    )</span>
<span id="cb10-7">)</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error:
! `n` must be a numeric vector
✖ You've supplied a &lt;character&gt; vector.</code></pre>
</div>
</div>
<p>In this example, we used inline text formatting to print <code>n</code> as a variable and interpolated code to print the class of <code>n</code> in the error message and all in just 6 lines of code.</p>
<p>If this is enough to excite your interests, check out <code>cli</code>’s <a href="https://cli.r-lib.org/">website</a> and help files, which provide in-depth guides on its myriad features.</p>
<p>Now, considering all these amazing features that <code>cli</code> offers, what should a package developer consider to adopt it? In this article, we will demonstrate how to use (micro)benchmarking<sup>1</sup> to guide the decision through the lense of speed. Benchmarking can be used to check whether adopting <code>cli</code> as a dependency would slow down existing printing processes in undesirable ways.</p>
<p>Here, we will benchmark <code>cli::cli_warn()</code> against base R’s <code>base::warning()</code> to see if the former has any speed issues. The results of this exercise will provide us with insights on whether its worth taking on <code>cli</code> for its features as a trade-off for slower printing speed.</p>
<section id="experiment" class="level2">
<h2 class="anchored" data-anchor-id="experiment">Experiment</h2>
<p>We will consider different scenarios of number of warnings thrown to tease out the relationship between speed of the function and number of warnings thrown in a function with and without <code>cli::cli_warn()</code>. We will also check how the benchmark scales with the number of warnings in the function.</p>
<p>Based on this description, we will need the following packages: <code>cli</code> for its warning function, and <a href="https://cran.r-project.org/web/packages/bench/index.html">bench</a> for measuring the run times, <a href="https://dplyr.tidyverse.org/">dplyr</a> for manipulating the results, and <a href="https://ggplot2.tidyverse.org/">ggplot2</a> for plotting.</p>
<p>Let’s define a function that takes an argument <code>n</code> for the number of warnings to throw and <code>pkg</code> for the type of package to use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">warn_Ntimes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(n, pkg) {</span>
<span id="cb12-2">  warning_msg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x must be an integer"</span></span>
<span id="cb12-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">switch</span>(pkg,</span>
<span id="cb12-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(n)) {</span>
<span id="cb12-5">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(warning_msg)</span>
<span id="cb12-6">    },</span>
<span id="cb12-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cli =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(n)) {</span>
<span id="cb12-8">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cli_warn</span>(warning_msg)</span>
<span id="cb12-9">    }</span>
<span id="cb12-10">  )</span>
<span id="cb12-11">}</span></code></pre></div>
</div>
<p>Let’s test our function to see if it works as expected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warn_Ntimes</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"base"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in warn_Ntimes(3, "base"): x must be an integer

Warning in warn_Ntimes(3, "base"): x must be an integer

Warning in warn_Ntimes(3, "base"): x must be an integer</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warn_Ntimes</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cli"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: x must be an integer</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: x must be an integer
x must be an integer</code></pre>
</div>
</div>
<p>Now, we’ll consider scenarios where a function throws 1, 5, 10, 15, 20, and 100 warnings using base R and <code>cli</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of warnings to throw</span></span>
<span id="cb18-2">warnings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span></code></pre></div>
</div>
<p>Let’s run benchmarks over the different scenarios and store results in a data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">bnmark_res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">press</span>(</span>
<span id="cb19-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warnings =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>),</span>
<span id="cb19-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mark</span>(</span>
<span id="cb19-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cli =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warn_Ntimes</span>(warnings, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cli"</span>),</span>
<span id="cb19-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warn_Ntimes</span>(warnings, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"base"</span>)</span>
<span id="cb19-6">    )</span>
<span id="cb19-7">  )</span></code></pre></div>
</div>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>It’s time to explore the results of the data generated. Let’s first make a boxplot of the run times for the different scenarios.</p>
<p>Drum roll please…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(</span>
<span id="cb20-2">  bnmark_res,</span>
<span id="cb20-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"boxplot"</span></span>
<span id="cb20-4">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb20-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Package"</span>,</span>
<span id="cb20-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Functions throwing various numbers of warnings as indicated in the facet label"</span></span>
<span id="cb20-8">  )</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required namespace: tidyr</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://epiverse-trace.github.io/posts/benchmarking_design_decisions/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now, let’s see how the benchmarks scale with the number of warnings thrown.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">bnmark_res<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pkg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(bnmark_res<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>expression, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"description"</span>)</span>
<span id="cb22-2"></span>
<span id="cb22-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(bnmark_res) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb22-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb22-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> warnings,</span>
<span id="cb22-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> median,</span>
<span id="cb22-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> pkg</span>
<span id="cb22-9">    ),</span>
<span id="cb22-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb22-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb22-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of warnigns"</span>,</span>
<span id="cb22-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median execution time"</span>,</span>
<span id="cb22-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Package"</span></span>
<span id="cb22-16">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://epiverse-trace.github.io/posts/benchmarking_design_decisions/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As we can see, <code>cli</code> is consistently slower than base R for the same number of warnings thrown. The median times also follow a similar non-linear trajectory. Benchmarking experiments with other <code>cli</code> functions have revealed similar non-linear relationships between its speed and the number of times it invokes those functions <sup>2</sup>. However, those exercises were not compared with equivalent functions in base R. The relative comparison here is useful for decision-making.</p>
<p>The developers of <code>cli</code> have also conducted benchmarks of the <code>ansi_*()</code> family of functions in <code>cli</code> in comparison to base R and the <code>fansi</code> package. They find that <code>cli</code> is consistently slower than base R, which corroborates the results of our experiment here. These benchmarks are available in the <code>cli</code> documentation <sup>3</sup>.</p>
<p>So, should we be worried about the speed of <code>cli</code>? Well, it depends on the context. The “R Packages” book by Hadley Wickham and Jenny Bryan suggests approaching such a decision from a holistic, balanced, and quantitative approach<span class="citation" data-cites="wickham2023r">(Wickham and Bryan 2023)</span>. We’ll leave the reader to make their own decision based on their use case.</p>
<p>Most developers might argue that this is an optimisation overkill<sup>4</sup>. However, it is important to consider speed differences in context. In the case of simple printing, the speed difference is negligible yet disruptive and somewhat painful. However, in the grand scheme of things, this might be nothing compared with much slower processes that need more attention. In those cases, the developer might want to consider other optimisation strategies such as profiling <sup>5</sup>. The essence of this experiment is to demonstrate the utility of benchmarking in making quick design decisions.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In designing R package infrastructure with dependencies, it might sometimes be necessary to check if they don’t slow down existing processes. Here, we have demonstrated how benchmarking is one way to achieve this for a process involving condition signalling. We show how a simple decision to use <code>cli::cli_warn()</code> to handle warnings could come at the cost of a tiny loss in speed, which is worth considering in its context.</p>
<p>The demonstration here can be extended to other dependency adoption decisions for input checking, loops, object manipulations, and so forth. We recommend benchmarking as a way to help developers make quick design decisions. However, we also recommend that developers consider the context of the optimisation in interpreting the results.</p>
<p><em>I would like to thank <a href="https://github.com/pratikunterwegs">Pratik Gupte</a>, <a href="https://github.com/joshwlambert">Joshua Lambert</a>, and <a href="https://github.com/Bisaloo">Hugo Gruson</a> for their invaluable reviews and suggestions that helped improve this post.</em></p>
</section>
<section id="other-r-packages-for-benchmarking" class="level2">
<h2 class="anchored" data-anchor-id="other-r-packages-for-benchmarking">Other R packages for benchmarking</h2>
<ul>
<li><a href="https://github.com/joshuaulrich/microbenchmark">microbenchmark</a>: an R package for comparing the execution time of R expressions.</li>
<li><a href="https://code.google.com/archive/p/rbenchmark/">rbenchmark</a>: an R package for benchmarking R code.</li>
<li><a href="https://github.com/collectivemedia/tictoc">tictok</a>: an R package to time R functions</li>
<li><a href="https://github.com/lorenzwalthert/touchstone/tree/main">touchstone</a>: an R package for benchmarking of pull requests with statistical confidence.</li>
</ul>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-wickham2019advanced" class="csl-entry">
Wickham, Hadley. 2019. <em>Advanced r</em>. CRC press.
</div>
<div id="ref-wickham2023r" class="csl-entry">
Wickham, Hadley, and Jennifer Bryan. 2023. <em>R Packages</em>. " O’Reilly Media, Inc.".
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Benchmark (Wikipedia): <a href="https://en.wikipedia.org/wiki/Benchmark_(computing)" class="uri">https://en.wikipedia.org/wiki/Benchmark_(computing)</a>↩︎</p></li>
<li id="fn2"><p>Formating errors can be slow/variable: <a href="https://github.com/r-lib/cli/issues/617" class="uri">https://github.com/r-lib/cli/issues/617</a>↩︎</p></li>
<li id="fn3"><p>cli benchmarks: <a href="https://cli.r-lib.org/articles/ansi-benchmark.html" class="uri">https://cli.r-lib.org/articles/ansi-benchmark.html</a>↩︎</p></li>
<li id="fn4"><p>Donald Knuth’s quoted as having said, “The real problem is that programmers have spent far too much time worrying about efficiency in the wrong places and at the wrong times; premature optimization is the root of all evil (or at least most of it) in programming.” (See <a href="https://en.wikiquote.org/wiki/Donald_Knuth" class="uri">https://en.wikiquote.org/wiki/Donald_Knuth</a>)↩︎</p></li>
<li id="fn5"><p>Profiling (Wikipedia): <a href="https://csgillespie.github.io/efficientR/performance.html" class="uri">https://csgillespie.github.io/efficientR/performance.html</a>↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{mba_azam2023,
  author = {Mba Azam, James},
  title = {Using Benchmarking to Guide the Adoption of Dependencies in
    {R} Packages},
  date = {2023-11-22},
  url = {https://epiverse-trace.github.io/posts/benchmarking_design_decisions/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-mba_azam2023" class="csl-entry quarto-appendix-citeas">
Mba Azam, James. 2023. <span>“Using Benchmarking to Guide the Adoption
of Dependencies in R Packages.”</span> November 22, 2023. <a href="https://epiverse-trace.github.io/posts/benchmarking_design_decisions/">https://epiverse-trace.github.io/posts/benchmarking_design_decisions/</a>.
</div></div></section></div> ]]></description>
  <category>benchmarking</category>
  <category>R</category>
  <category>cli</category>
  <category>R package</category>
  <category>software architecture</category>
  <guid>https://epiverse-trace.github.io/posts/benchmarking_design_decisions/</guid>
  <pubDate>Wed, 22 Nov 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>bpmodels v0.3.1</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/bpmodels_v0.3.1/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new bpmodels version v0.3.1. Here is an automatically generated summary of the changes in this version.</p>
<section id="input-validation" class="level2">
<h2 class="anchored" data-anchor-id="input-validation">Input validation</h2>
<ul>
<li>The following internal functions now have input validation: <code>rborel()</code>, <code>dborel()</code>, <code>complementary_logprob()</code>, and <code>rnbinom_mean_disp()</code>.</li>
</ul>
</section>
<section id="unit-tests" class="level2">
<h2 class="anchored" data-anchor-id="unit-tests">Unit tests</h2>
<ul>
<li>Code coverage has been improved with more tests on the following functions: <code>rborel()</code>, <code>dborel()</code>, <code>chain_sim()</code>, <code>rnbinom_mean_disp()</code>, <code>complementary_logprob()</code>, <code>rgen_length()</code>, and <code>rbinom_size()</code>.</li>
</ul>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2023,
  author = {Epiverse-TRACE development team, The},
  title = {Bpmodels V0.3.1},
  date = {2023-11-06},
  url = {https://epiverse-trace.github.io/posts/bpmodels_v0.3.1/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2023" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2023. <span>“Bpmodels
V0.3.1.”</span> November 6, 2023. <a href="https://epiverse-trace.github.io/posts/bpmodels_v0.3.1/">https://epiverse-trace.github.io/posts/bpmodels_v0.3.1/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/bpmodels_v0.3.1/</guid>
  <pubDate>Mon, 06 Nov 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Lesser-known reasons to prefer apply() over for loops</title>
  <dc:creator>Hugo Gruson</dc:creator>
  <link>https://epiverse-trace.github.io/posts/for-vs-apply/</link>
  <description><![CDATA[ 





<p>The debate regarding the use of <code>for</code> loops versus the <code>apply()</code> function family (<code>apply()</code>, <code>lapply()</code>, <code>vapply()</code>, etc., along with their purrr counterparts: <code>map()</code>, <code>map2()</code>, <code>map_lgl()</code>, <code>map_chr()</code>, etc.), has been a longstanding one in the R community.</p>
<p>While you may occasionally hear that <code>for</code> loops are slower, this notion has already been debunked <a href="https://privefl.github.io/blog/why-loops-are-slow-in-r/">in other posts</a>. When utilized correctly, a <code>for</code> loop can achieve performance on par with <code>apply()</code> functions.</p>
<p>However, there are still lesser-known reasons to prefer <code>apply()</code> functions over <code>for</code> loops, which we will explore in this post.</p>
<section id="preamble-for-loops-can-be-used-in-more-cases-than-apply" class="level2">
<h2 class="anchored" data-anchor-id="preamble-for-loops-can-be-used-in-more-cases-than-apply">Preamble: <code>for</code> loops can be used in more cases than <code>apply()</code></h2>
<p>It is important to understand that <code>for</code> loops and <code>apply()</code> functions are not always interchangeable. Indeed, <code>for</code> loops can be used in cases where <code>apply</code> functions can’t: when the next step depends on the previous one. This concept is known as <a href="https://en.wikipedia.org/wiki/Recursion"><em>recursion</em></a>.</p>
<p>Conversely, when each step is independent of the previous one, but you want to perform the same operation on each element of a vector, it is referred to as <a href="https://en.wikipedia.org/wiki/Iteration"><em>iteration</em></a>.</p>
<p><code>for</code> loops are capable of both <em>recursion</em> and <em>iteration</em>, whereas <code>apply()</code> can only do <em>iteration</em>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operator</th>
<th>Iteration</th>
<th>Recursion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>for</code></td>
<td>✔️</td>
<td>✔️</td>
</tr>
<tr class="even">
<td><code>apply()</code></td>
<td>✔️</td>
<td>❌</td>
</tr>
</tbody>
</table>
<p>With this distinction in mind, we can now focus on why you should favour <code>apply()</code> for iteration over <code>for</code> loops.</p>
</section>
<section id="reason-1-clarity-of-intent" class="level2">
<h2 class="anchored" data-anchor-id="reason-1-clarity-of-intent">Reason 1: clarity of intent</h2>
<p>As mentioned earlier, <code>for</code> loops can be used for both iteration and recursion. By consistently employing <code>apply()</code> for iteration<sup>1</sup> and reserving <code>for</code> loops for recursion, we enable readers to immediately discern the underlying concept in the code. This leads to code that is easier to read and understand.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">l <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `for` solution -------------------</span></span>
<span id="cb1-4">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(l))</span>
<span id="cb1-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(l)) {</span>
<span id="cb1-6">  res[[i]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(l[[i]])</span>
<span id="cb1-7">}</span>
<span id="cb1-8">res</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.0 4.0 6.0 4.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `vapply()` solution ---------------</span></span>
<span id="cb3-2">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(l, mean, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb3-3">res</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.0 4.0 6.0 4.8</code></pre>
</div>
</div>
<p>The simplicity of <code>apply()</code> is even more apparent in the case of multiple iterations. For example, if we want to find the median of each matrix row for a list of matrices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">l <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, { <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) }, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">simplify =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `for` solution -------------------</span></span>
<span id="cb5-4">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb5-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(l)) {</span>
<span id="cb5-6">  meds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(l[[i]]))</span>
<span id="cb5-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(l[[i]]))) {</span>
<span id="cb5-8">    meds[[j]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(l[[i]][j, ])</span>
<span id="cb5-9">  }</span>
<span id="cb5-10">  res[[i]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> meds</span>
<span id="cb5-11">}</span>
<span id="cb5-12">res</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 0.7807203 0.2448108 0.7407391

[[2]]
[1] 0.3249898 0.1742138 0.3917644

[[3]]
[1] 0.2876697 0.8835354 0.5606563

[[4]]
[1] 0.08360038 0.37515714 0.43738127

[[5]]
[1] 0.4834298 0.6106350 0.6328951</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `vapply()` solution ---------------</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(l, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(e) {</span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(e, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, median)</span>
<span id="cb7-4">})</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 0.7807203 0.2448108 0.7407391

[[2]]
[1] 0.3249898 0.1742138 0.3917644

[[3]]
[1] 0.2876697 0.8835354 0.5606563

[[4]]
[1] 0.08360038 0.37515714 0.43738127

[[5]]
[1] 0.4834298 0.6106350 0.6328951</code></pre>
</div>
</div>
<p>Moreover, this clarity of intent is not limited to human readers alone; automated static analysis tools can also more effectively identify suboptimal patterns. This can be demonstrated using R most popular static analysis tool: the lintr package, suggesting vectorized alternatives:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">lintr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lint</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vapply(l, length, numeric(1))"</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3">lintr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lint</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apply(m, 1, sum)"</span>)</span></code></pre></div>
</div>
</section>
<section id="reason-2-code-compactness-and-conciseness" class="level2">
<h2 class="anchored" data-anchor-id="reason-2-code-compactness-and-conciseness">Reason 2: code compactness and conciseness</h2>
<p>As illustrated in the preceding example, <code>apply()</code> often leads to more compact code, as much of the boilerplate code is handled behind the scenes: you don’t have to initialize your variables, manage indexing, etc.</p>
<p>This, in turn, impacts code readability since:</p>
<ul>
<li>The boilerplate code does not offer meaningful insights into the algorithm or implementation and can be seen as visual noise.</li>
<li>While compactness should never take precedence over readability, a more compact solution allows for more code to be displayed on the screen without scrolling. This ultimately makes it easier to understand what the code is doing. With all things otherwise equal, the more compact solution should thus be preferred.</li>
</ul>
</section>
<section id="reason-3-variable-leak" class="level2">
<h2 class="anchored" data-anchor-id="reason-3-variable-leak">Reason 3: variable leak</h2>
<p>As discussed in the previous sections, you have to manually manage the iteration index in a <code>for</code> loop, whereas they are abstracted in <code>apply()</code>. This can sometimes lead to perplexing errors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (k <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Paul"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pierre"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jacques"</span>)) {</span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hello "</span>, k)</span>
<span id="cb10-5">}</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Hello Paul</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Hello Pierre</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Hello Jacques</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(letters, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> k)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in rep(letters, times = k): invalid 'times' argument</code></pre>
</div>
</div>
<p>This is because the loop index variable leaks into the global environment and can overwrite existing variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (k <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb17-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># do something</span></span>
<span id="cb17-3">}</span>
<span id="cb17-4"></span>
<span id="cb17-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The value of k is now "</span>, k)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The value of k is now 3</code></pre>
</div>
</div>
</section>
<section id="reason-4-pipelines" class="level2">
<h2 class="anchored" data-anchor-id="reason-4-pipelines">Reason 4: pipelines</h2>
<p>The final reason is that <code>apply()</code> (or more commonly in this situation <code>purrr::map()</code>) can be used in pipelines due to their functional nature:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">l <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Without pipe</span></span>
<span id="cb19-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(l, mean, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.0 4.0 6.0 4.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># With pipe</span></span>
<span id="cb21-2">l <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(mean, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.0 4.0 6.0 4.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">l <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dbl</span>(mean)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.0 4.0 6.0 4.8</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>This post hopefully convinced you why it’s better to use <code>apply()</code> functions rather than <code>for</code> loops where possible (i.e., for iteration). Contrary to common misconception, the real reason is not performance, but code robustness and readability.</p>
<p><em>Thanks to Jaime Pavlich-Mariscal, James Azam, Tim Taylor, and Pratik Gupte for their thoughtful comments and suggestions on earlier drafts of this post.</em></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Beyond R">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Beyond R
</div>
</div>
<div class="callout-body-container callout-body">
<p>This post focused on R, but the same principles generally apply to other functional languages. In Python for example, you would use <a href="https://www.w3schools.com/python/python_lists_comprehension.asp">list comprehensions</a> or the <a href="https://www.w3schools.com/python/ref_func_map.asp"><code>map()</code> function</a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Further reading">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Further reading
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you liked the code patterns recommended in this post and want to use functional programming in more situations, including recursion, I recommend you check out the <a href="https://adv-r.hadley.nz/functionals.html#functionals">“Functionals” chapter of the <em>Advanced R</em> book by Hadley Wickham</a></p>
</div>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>There are a handful of rare corner cases where <code>apply()</code> is not the best method for iteration. These are cases that make use of <code>match.call()</code> or <code>sys.call()</code>. More details are available in <code>lapply()</code> documentation and in <a href="https://github.com/epiverse-trace/epiverse-trace.github.io/pull/125#issuecomment-1775929451">this GitHub comment by Tim Taylor during the review of this post</a>.↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{gruson2023,
  author = {Gruson, Hugo},
  title = {Lesser-Known Reasons to Prefer `Apply()` over for Loops},
  date = {2023-11-02},
  url = {https://epiverse-trace.github.io/posts/for-vs-apply/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-gruson2023" class="csl-entry quarto-appendix-citeas">
Gruson, Hugo. 2023. <span>“Lesser-Known Reasons to Prefer `Apply()` over
for Loops.”</span> November 2, 2023. <a href="https://epiverse-trace.github.io/posts/for-vs-apply/">https://epiverse-trace.github.io/posts/for-vs-apply/</a>.
</div></div></section></div> ]]></description>
  <category>R</category>
  <category>functional programming</category>
  <category>iteration</category>
  <category>readability</category>
  <category>good practices</category>
  <category>tidyverse</category>
  <guid>https://epiverse-trace.github.io/posts/for-vs-apply/</guid>
  <pubDate>Thu, 02 Nov 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>linelist v1.0.0</title>
  <dc:creator>The Epiverse-TRACE development team</dc:creator>
  <link>https://epiverse-trace.github.io/posts/linelist_v1.0.0/</link>
  <description><![CDATA[ 





<p>We are very excited to announce the release of a new linelist version v1.0.0. Here is a automatically generated summary of the changes in this version.</p>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New features</h2>
<ul>
<li><p>Increased compatibility with dplyr is now documented and ensured through tests of all dplyr verbs on linelist objects as part of our testing &amp; continuous integration system, as well as a new vignette: <a href="https://epiverse-trace.github.io/linelist/articles/compat-dplyr.html" class="uri">https://epiverse-trace.github.io/linelist/articles/compat-dplyr.html</a> (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #53)</p></li>
<li><p>A new selection helper is provided for tidyverse users, based on the existing selectors provided by the tidyselect package: <code>has_tag()</code> (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #61). By feeding it a character vector of tags to operate on, you can work with dplyr verbs on specific tagged columns without having to explicitly use the column names:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">has_tag</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"date_of_onset"</span>)))</span></code></pre></div></li>
</ul>
</section>
<section id="breaking-changes" class="level2">
<h2 class="anchored" data-anchor-id="breaking-changes">Breaking changes</h2>
<ul>
<li><p>It is no longer possible to use <code>lost_tags_action()</code> within a pipeline. It must now be set as a separate step. This makes the internal code more robust and clarifies what is part of the pipeline versus a global option (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #79).</p></li>
<li><p>The <code>select_tags()</code> function is now deprecated to ensure we provide just one clear way to address a given issue and that our “happy path” is clearly signposted (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #61). If you were using this function, we now recommend using the more explicit two-steps process:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Deprecated</span></span>
<span id="cb2-2">x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_tags</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>)</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Instead use</span></span>
<span id="cb2-6">x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tags_df</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(age)</span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Or</span></span>
<span id="cb2-11">x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">has_tag</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"age"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tags_df</span>()</span></code></pre></div></li>
<li><p>The custom <code>select.linelist()</code> method has been deprecated as providing a custom <code>[.linelist()</code> is sufficient to ensure compatibility with <code>dplyr::select()</code> default methods, including triggering <code>lost_tags_action()</code> on tag removal (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #61). A full deletion of this method is not possible at the moment because we want to provide a smooth transition for users that relied on the custom <code>tags</code> argument of the <code>select.linelist()</code> method. It is now recommend instead to use the new <code>has_tag()</code> selection helper:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">has_tag</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"date_of_onset"</span>)))</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Instead of</span></span>
<span id="cb3-5">x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tags =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"date_of_onset"</span>))</span></code></pre></div></li>
<li><p>The custom <code>rename.linelist()</code> method has been removed as providing a custom <code>names&lt;-().linelist</code> method is sufficient to ensure compatibility with <code>dplyr::rename()</code>, including appropriate modification of the tags. (<span class="citation" data-cites="Bisaloo">@Bisaloo</span>, #60)</p></li>
</ul>
</section>
<section id="documentation" class="level2">
<h2 class="anchored" data-anchor-id="documentation">Documentation</h2>
<ul>
<li><p>added a hex logo thanks to David Mascarina’s contribution (<span class="citation" data-cites="dgmascarina">@dgmascarina</span>)</p></li>
<li><p>added short lay description to README thanks to Emma Marty’s contribution</p></li>
</ul>
</section>
<section id="bug-fixes" class="level2">
<h2 class="anchored" data-anchor-id="bug-fixes">Bug fixes</h2>
<ul>
<li>linelist is now explicitly marked as incompatible with data.table. In practice, <code>make_linelist(x)</code> now errors if <code>x</code> inherits from <code>data.table</code> (#55, <span class="citation" data-cites="Bisaloo">@Bisaloo</span>, based on discussions with <span class="citation" data-cites="TimTaylor">@TimTaylor</span>).</li>
<li><code>[.linelist()</code> now works to subset by column when including just one argument (#54, <span class="citation" data-cites="Bisaloo">@Bisaloo</span>). E.g., <code>x[1]</code>. As an indirect effect, this also improves compatibility with dplyr verbs that rely on this method (#51).</li>
<li>subsetting a linelist with extra tags (e.g., created via <code>make_linelist(allow_extra = TRUE)</code>) no longer causes an error (#65, <span class="citation" data-cites="Bisaloo">@Bisaloo</span>; reported by <span class="citation" data-cites="TimTaylor">@TimTaylor</span> in #63)</li>
</ul>
</section>
<section id="internal-changes" class="level2">
<h2 class="anchored" data-anchor-id="internal-changes">Internal changes</h2>
<ul>
<li>testthat tests now run in parallel (#76, <span class="citation" data-cites="Bisaloo">@Bisaloo</span>)</li>
<li>testthat tests now warn on partial matching (#76, <span class="citation" data-cites="Bisaloo">@Bisaloo</span>)</li>
</ul>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{epiverse-trace_development_team2023,
  author = {Epiverse-TRACE development team, The},
  title = {Linelist V1.0.0},
  date = {2023-10-19},
  url = {https://epiverse-trace.github.io/posts/linelist_v1.0.0/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-epiverse-trace_development_team2023" class="csl-entry quarto-appendix-citeas">
Epiverse-TRACE development team, The. 2023. <span>“Linelist
V1.0.0.”</span> October 19, 2023. <a href="https://epiverse-trace.github.io/posts/linelist_v1.0.0/">https://epiverse-trace.github.io/posts/linelist_v1.0.0/</a>.
</div></div></section></div> ]]></description>
  <category>new-release</category>
  <guid>https://epiverse-trace.github.io/posts/linelist_v1.0.0/</guid>
  <pubDate>Thu, 19 Oct 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>System Dependencies in R Packages &amp; Automatic Testing</title>
  <dc:creator>Hugo Gruson</dc:creator>
  <link>https://epiverse-trace.github.io/posts/system-dependencies/</link>
  <description><![CDATA[ 





<p><em>This post has been <a href="https://blog.r-hub.io/2023/09/26/system-dependency/">cross-posted on the R-hub blog</a>, and the R-hub blog maintainers have contributed to the review and improvement of this post.</em></p>
<p>In a <a href="https://blog.r-hub.io/2022/09/12/r-dependency/">previous R-hub blog post</a>, we discussed a package dependency that goes slightly beyond the normal R package ecosystem dependency: R itself. Today, we step even further and discuss dependencies outside of R: system dependencies. This happens when packages rely on external software, such as how <a href="https://github.com/search?q=org%3Acran+cuda+path%3ADESCRIPTION&amp;type=code">R packages integrating CUDA GPU computation in R</a> require the <a href="https://en.wikipedia.org/wiki/CUDA">CUDA library</a>. In particular, we are going to talk about system dependencies in the context of automated testing: is there anything extra to do when setting continuous integration for your package with system dependencies? In particular, we will focus with the integration with <a href="https://beamilz.com/posts/series-gha/2022-series-gha-1-what-is/en/">GitHub Actions</a>. How does it work behind the scenes? And how to work with edge cases?</p>
<section id="introduction-specifying-system-dependencies-in-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="introduction-specifying-system-dependencies-in-r-packages">Introduction: specifying system dependencies in R packages</h2>
<p>Before jumping right into the topic of continuous integration, let’s take a moment to introduce, or remind you, how system dependencies are specified in R packages.</p>
<p>The official ‘Writing R Extensions’ guide states <sup>1</sup>:</p>
<blockquote class="blockquote">
<p>Dependencies external to the R system should be listed in the ‘SystemRequirements’ field, possibly amplified in a separate README file.</p>
</blockquote>
<p>This was initially purely designed for humans. No system within R itself makes use of it. One important thing to note is that this field contains free text :scream:. As such, to refer to the same piece of software, you could write either one of the following in the package <code>DESCRIPTION</code>:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">SystemRequirements</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ExternalSoftware</span></span></code></pre></div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">SystemRequirements</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ExternalSoftware 0.1</span></span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">SystemRequirements</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> lib-externalsoftware</span></span></code></pre></div>
<p>However, it is probably good practice check what other R packages with similar system dependencies are writing in <code>SystemRequirements</code>, to facilitate the automated identification process we describe below.</p>
</section>
<section id="the-general-case-everything-works-automagically" class="level2">
<h2 class="anchored" data-anchor-id="the-general-case-everything-works-automagically">The general case: everything works automagically</h2>
<p>If while reading the previous section, you could already sense the problems linked to the fact <code>SystemRequirements</code> is a free-text field, fret not! In the very large majority of cases, setting up continuous integration in an R package with system dependencies is exactly the same as with any other R package.</p>
<p>Using, as often, the supercharged usethis package, you can automatically create the relevant GitHub Actions workflow file in your project <sup>2</sup>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">usethis<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use_github_action</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"check-standard"</span>)</span></code></pre></div>
</div>
<p>The result is:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Workflow derived from https://github.com/r-lib/actions/tree/v2/examples</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Need help debugging build failures? Start at https://github.com/r-lib/actions#where-to-find-help</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">push</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">branches</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> master</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]</span></span>
<span id="cb5-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_request</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">branches</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> master</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> R-CMD-check</span></span>
<span id="cb5-10"></span>
<span id="cb5-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">jobs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">R-CMD-check</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runs-on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ matrix.config.os }}</span></span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ matrix.config.os }} (${{ matrix.config.r }})</span></span>
<span id="cb5-16"></span>
<span id="cb5-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strategy</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fail-fast</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb5-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">config</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">os</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> macos-latest</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">   </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'release'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span>
<span id="cb5-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">os</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> windows-latest</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'release'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span>
<span id="cb5-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">os</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ubuntu-latest</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'devel'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">http-user-agent</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'release'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span>
<span id="cb5-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">os</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ubuntu-latest</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'release'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span>
<span id="cb5-25"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">{</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">os</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ubuntu-latest</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'oldrel-1'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">}</span></span>
<span id="cb5-26"></span>
<span id="cb5-27"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-28"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GITHUB_PAT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.GITHUB_TOKEN }}</span></span>
<span id="cb5-29"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">R_KEEP_PKG_SOURCE</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">yes</span></span>
<span id="cb5-30"></span>
<span id="cb5-31"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">steps</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-32"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> actions/checkout@v3</span></span>
<span id="cb5-33"></span>
<span id="cb5-34"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> r-lib/actions/setup-pandoc@v2</span></span>
<span id="cb5-35"></span>
<span id="cb5-36"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> r-lib/actions/setup-r@v2</span></span>
<span id="cb5-37"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-38"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">r-version</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ matrix.config.r }}</span></span>
<span id="cb5-39"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">http-user-agent</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ matrix.config.http-user-agent }}</span></span>
<span id="cb5-40"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use-public-rspm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb5-41"></span>
<span id="cb5-42"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> r-lib/actions/setup-r-dependencies@v2</span></span>
<span id="cb5-43"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-44"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extra-packages</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> any::rcmdcheck</span></span>
<span id="cb5-45"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">needs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> check</span></span>
<span id="cb5-46"></span>
<span id="cb5-47"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> r-lib/actions/check-r-package@v2</span></span>
<span id="cb5-48"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb5-49"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">upload-snapshots</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span></code></pre></div>
<p>You may notice there is no explicit mention of system dependencies in this file. Yet, if we use this workflow in an R package with system dependencies, everything will work out-of-the-box in most cases. So, when are system dependencies installed? And how the workflow does even know which dependencies to install since the <code>SystemRequirements</code> is free text that may not correspond to the exact name of a library?</p>
<p>The magic happens in the <code>r-lib/actions/setup-r-dependencies</code> step. If you want to learn about it, you can read the <a href="https://github.com/r-lib/actions/blob/756399d909bf9c180bbdafe8025f794f51f2da02/setup-r-dependencies/action.yaml">source code of this step</a>. It is mostly written in R but it contains a lot of bells and whistles to handle messaging within the GitHub Actions context and as such, it would be too long to go through it line by line in this post. However, at a glance, you can notice many mentions of the <a href="https://pak.r-lib.org/">pak R package</a>.</p>
<p>If it’s the first time you’re hearing about the pak package, we strongly recommend we go through the <a href="https://pak.r-lib.org/reference/features.html">list of the most important pak features</a>. It is <del>paked</del> packed with many very powerful features. The specific feature we’re interested in here is the automatic install of system dependencies via <a href="https://pak.r-lib.org/reference/local_system_requirements.html"><code>pak::pkg_sysreqs()</code></a>, which in turn uses <code>pkgdepends::sysreqs_install_plan()</code>.</p>
<p>We now understand more precisely where the magic happens but it still doesn’t explain how pak is able to know which precise piece of software to install from the free text <code>SystemRequirements</code> field. As often when you want to increase your understanding, it is helpful to <a href="https://blog.r-hub.io/2019/05/14/read-the-source/">read the source</a>. While browsing pkgdepends source code, we see a call to <a href="https://github.com/r-hub/r-system-requirements" class="uri">https://github.com/r-hub/r-system-requirements</a>.</p>
<p>This repository contains a set of <a href="https://github.com/rstudio/r-system-requirements/tree/main/rules">rules</a> as json files which match unformatted software name via regular expressions to the exact libraries for each major operating system. Let’s walk through an example together:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-2">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"patterns"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">bnvcc</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">bcuda</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb6-3">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"dependencies"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb6-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-5">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"packages"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nvidia-cuda-dev"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb6-6">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"constraints"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb6-7">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-8">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"os"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linux"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb6-9">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"distribution"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ubuntu"</span></span>
<span id="cb6-10">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-11">      <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb6-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-13">  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb6-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>The regular expression tells that each time a package lists something as <code>SystemRequirements</code> with the word “nvcc” or “cuda”, the corresponding Ubuntu library to install is <code>nvidia-cuda-dev</code>.</p>
<p>This interaction between <code>r-system-requirements</code> and pak is also documented in pak’s dev version, with extra information about how the <code>SystemRequirements</code> field is extracted in different situations: <a href="https://pak.r-lib.org/dev/reference/sysreqs.html#how-it-works" class="uri">https://pak.r-lib.org/dev/reference/sysreqs.html#how-it-works</a></p>
</section>
<section id="when-its-not-working-out-of-the-box" class="level2">
<h2 class="anchored" data-anchor-id="when-its-not-working-out-of-the-box">When it’s not working out-of-the-box</h2>
<p>We are now realizing that this automagical setup we didn’t pay so much attention to until now actually requires a very heavy machinery under the hood. And it happens, very rarely, that this complex machinery is not able to handle your specific use case. But it doesn’t mean that you cannot use continuous integration in your package. It means that some extra steps might be required to do so. Let’s review these possible solutions together in order of complexity.</p>
<section id="fix-it-for-everybody-by-submitting-a-pull-request" class="level3">
<h3 class="anchored" data-anchor-id="fix-it-for-everybody-by-submitting-a-pull-request">Fix it for everybody by submitting a pull request</h3>
<p>One first option might be that the regular expression used by <code>r-system-requirements</code> to convert the free text in <code>SystemRequirements</code> to a library distributed by your operating system does not recognize what is in <code>SystemRequirements</code>.</p>
<p>To identify if this is the case, you need to find the file containing the specific rule for the system dependency of interest in <code>r-system-requirements</code>, and test the regular expression on the contents of <code>SystemRequirements</code>.</p>
<p>If we re-use the cuda example from the previous section and we are wondering why it is not automatically installed for a package specifying “cudaa”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">stringr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_match</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cudaa"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">bnvcc</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">bcuda</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">b"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,] NA  
[2,] NA  </code></pre>
</div>
</div>
<p>This test confirms that the <code>SystemRequirements</code> field contents are not recognized by the regular expression. Depending on the case, the best course of action might be to:</p>
<ul>
<li>either edit the contents of <code>SystemRequirements</code> so that it’s picked up by the regular expression</li>
<li>or submit a pull request to <a href="https://github.com/rstudio/r-system-requirements"><code>rstudio/r-system-requirements</code></a> <sup>3</sup> if you believe the regular expression is too restrictive and should be updated (<a href="https://github.com/rstudio/r-system-requirements/pull/93">example</a>)</li>
</ul>
<p>Note however that the first option is likely always the simplest as it doesn’t impact all the rest of the ecosystem (which is why <code>r-system-requirements</code> maintainers might be reluctant to relax a regular expression) and it is often something directly in your control, rather than a third-party who might not immediately be available to review your PR.</p>
</section>
<section id="install-system-dependencies-manually" class="level3">
<h3 class="anchored" data-anchor-id="install-system-dependencies-manually">Install system dependencies “manually”</h3>
<p>However, you might be in a case where you cannot rely on the automated approach. For example, maybe the system dependency to install is not provided by package managers at all. Typically, if you had to compile or install it manually on your local computer, you’re very likely to have to do the same operation in GitHub Actions. There two different, but somewhat equivalent, ways to do so, as detailed below.</p>
<section id="directly-in-the-github-actions-workflow" class="level4">
<h4 class="anchored" data-anchor-id="directly-in-the-github-actions-workflow">Directly in the GitHub Actions workflow</h4>
<p>You can insert the installation steps you used locally in the GitHub Actions workflow file. So, instead of having the usual structure, you have an extra step “Install extra system dependencies manually” that may look something like this:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode diff code-with-copy"><code class="sourceCode diff"><span id="cb9-1">jobs:</span>
<span id="cb9-2">  R-CMD-check:</span>
<span id="cb9-3">    runs-on: ubuntu-latest</span>
<span id="cb9-4">    env:</span>
<span id="cb9-5">      GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}</span>
<span id="cb9-6">      R_KEEP_PKG_SOURCE: yes</span>
<span id="cb9-7">    steps:</span>
<span id="cb9-8">      - uses: actions/checkout@v3</span>
<span id="cb9-9"></span>
<span id="cb9-10">      - uses: r-lib/actions/setup-r@v2</span>
<span id="cb9-11">        with:</span>
<span id="cb9-12">          use-public-rspm: true</span>
<span id="cb9-13"></span>
<span id="cb9-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+      - name: Install extra system dependencies manually</span></span>
<span id="cb9-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+        run:</span></span>
<span id="cb9-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+          wget ...</span></span>
<span id="cb9-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+          make</span></span>
<span id="cb9-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+          sudo make install</span></span>
<span id="cb9-19"></span>
<span id="cb9-20">      - uses: r-lib/actions/setup-r-dependencies@v2</span>
<span id="cb9-21">        with:</span>
<span id="cb9-22">          extra-packages: any::rcmdcheck</span>
<span id="cb9-23">          needs: check</span>
<span id="cb9-24"></span>
<span id="cb9-25">      - uses: r-lib/actions/check-r-package@v2</span></code></pre></div>
<p>You can see <a href="https://github.com/sbfnk/rbi/blob/9b05a24ce42f7b1b53481370f3bde3dcd86bca02/.github/workflows/R-CMD-check.yaml">a real-life example in the rbi R package</a>.</p>
</section>
<section id="using-a-docker-image-in-github-actions" class="level4">
<h4 class="anchored" data-anchor-id="using-a-docker-image-in-github-actions">Using a Docker image in GitHub Actions</h4>
<p>Alternatively, you can do the manual installation in a Docker image and use this image in your GitHub Actions workflow. This is a particularly good solution if there is already a public Docker image or you already wrote a <code>DOCKERFILE</code> for your own local development purposes. If you use a public image, you can follow <a href="https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#example-running-a-job-within-a-container">the steps in the official documentation</a> to integrate it to your GitHub Actions job. If you use a <code>DOCKERFILE</code>, you can follow <a href="https://stackoverflow.com/q/61154750/4439357">the answers to this stackoverflow question</a> (in a nutshell, use <code>docker compose</code> in your job or publish the image first and then follow the official documentation).</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode diff code-with-copy"><code class="sourceCode diff"><span id="cb10-1">jobs:</span>
<span id="cb10-2">  R-CMD-check:</span>
<span id="cb10-3">    runs-on: ubuntu-latest</span>
<span id="cb10-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">+    container: ghcr.io/org/repo:main</span></span>
<span id="cb10-5">    env:</span>
<span id="cb10-6">      GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}</span>
<span id="cb10-7">      R_KEEP_PKG_SOURCE: yes</span>
<span id="cb10-8">    steps:</span>
<span id="cb10-9">      - uses: actions/checkout@v3</span>
<span id="cb10-10"></span>
<span id="cb10-11">      - uses: r-lib/actions/setup-r@v2</span>
<span id="cb10-12">        with:</span>
<span id="cb10-13">          use-public-rspm: true</span>
<span id="cb10-14"></span>
<span id="cb10-15">      - uses: r-lib/actions/setup-r-dependencies@v2</span>
<span id="cb10-16">        with:</span>
<span id="cb10-17">          extra-packages: any::rcmdcheck</span>
<span id="cb10-18">          needs: check</span>
<span id="cb10-19"></span>
<span id="cb10-20">      - uses: r-lib/actions/check-r-package@v2</span></code></pre></div>
<p>You can again see <a href="https://github.com/sbfnk/rbi/pull/46/files">a real-life example in the rbi R package</a>.</p>
</section>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this post, we have provided an overview of how to specify system requirements for R package, how this seemingly innocent task requires a very complex infrastructure so that it can be understood by automated tools and that your dependencies are smoothly installed in a single command. We also gave some pointers on what to do if you’re in one of the rare cases where the automated tools don’t or can’t work.</p>
<p>One final note on this topic is that there might be a move from CRAN to start requiring more standardization in the <code>SystemRequirements</code> field. One R package developer has reported being asked to change “Java JRE 8 or higher” to “Java (&gt;= 8)”.</p>
<p><em>Many thanks to <a href="https://masalmon.eu/">Maëlle Salmon</a> &amp; <a href="https://github.com/gaborcsardi">Gábor Csárdi</a> for their insights into this topic and their valuable feedback on this post.</em></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>For R history fans, this has been the case <a href="https://github.com/r-devel/r-svn/blob/9c46956fd784c6985867aca069b926d774602928/doc/NEWS.1#L2348-L2350">since R 1.7.0</a>, released in April 2003.↩︎</p></li>
<li id="fn2"><p>Alternatively, if you’re not using usethis, you can manually copy-paste the relevant GitHub Actions workflow file from the <a href="https://github.com/r-lib/actions/tree/HEAD/examples"><code>examples</code> of the <code>r-lib/actions</code> project</a>.↩︎</p></li>
<li id="fn3"><p>If you are wondering why we are saying to submit PR to <code>rstudio/r-system-requirements</code> when we were previously talking about <code>r-hub/r-system-requirements</code>, you can check out <a href="https://github.com/r-hub/blog/pull/165#discussion_r1280644182">this comment thread</a>.↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{gruson2023,
  author = {Gruson, Hugo},
  title = {System {Dependencies} in {R} {Packages} \&amp; {Automatic}
    {Testing}},
  date = {2023-09-26},
  url = {https://epiverse-trace.github.io/posts/system-dependencies/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-gruson2023" class="csl-entry quarto-appendix-citeas">
Gruson, Hugo. 2023. <span>“System Dependencies in R Packages &amp;
Automatic Testing.”</span> September 26, 2023. <a href="https://epiverse-trace.github.io/posts/system-dependencies/">https://epiverse-trace.github.io/posts/system-dependencies/</a>.
</div></div></section></div> ]]></description>
  <category>package development</category>
  <category>R</category>
  <category>R package</category>
  <category>continuous integration</category>
  <category>system dependencies</category>
  <guid>https://epiverse-trace.github.io/posts/system-dependencies/</guid>
  <pubDate>Tue, 26 Sep 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Communicating development stages of open-source software</title>
  <dc:creator>Joshua W. Lambert</dc:creator>
  <link>https://epiverse-trace.github.io/posts/comm-software-devel/</link>
  <description><![CDATA[ 





<p>Software is not immediately stable when being developed. It undergoes design changes, changes to the user interface (application programming interface, API), and features get added or removed over time. Software in a open-source setting, in which the code is publicly hosted in a repository (e.g., Github, GitLab, Bitbucket), allows anyone to track developments. It also allows the developer community to easily contribute to the software.</p>
<p>There are certain metrics which can be used to convey the stage of development to users or other developers. For example the number of commits, a repository with few commits may indicate that a project is still in an incipient phase and will undergo several breaking changes. However, different software projects become stable at different rates and the number of commits may mean very different things for a repository containing an operating system compared to an R package with minimal functionality. It is therefore important that developers communicate with users and other developers at what stage the project is in, and how stable the code base is.</p>
<p>Software development, and specifically R package development, has several methods to communicate stability. This blog post will discuss two such methods and give examples for each. The first of these is versioning code, which establishes points in development where the code is ready for use; and the second is lifecycle badges, these can be placed at a different levels within software (e.g., package, function, function argument) to convey how a user should interact and use.</p>
<section id="versioning" class="level2">
<h2 class="anchored" data-anchor-id="versioning">Versioning</h2>
<p>Versioning code is not a new concept and has been used for decades<sup>1</sup>. It has led to version control systems such as <a href="https://git-scm.com/">git</a>. However, in this post we are interested in versioning to communicate development.</p>
<section id="semantic-versioning" class="level3">
<h3 class="anchored" data-anchor-id="semantic-versioning">Semantic versioning</h3>
<p>One such philosophy is <a href="https://semver.org/">semantic versioning</a> (SemVer). This aims to describe the stage of software development by attaching semantics (i.e.&nbsp;meaning) to the format and numbering of versions. The version system works through three numbers, each separated by a dot. The numbers, from left to right, convey major version, minor version and patch version. As an example, 0.5.2, is newer than 0.3.9.</p>
<p>Employing semantic versioning in ones code development allows others to determine whether a package has undergone substantial development and testing, and informs to whether it would make a suitable package to use in a script or as a dependency for another package. Semantic versioning also describes the changes made to a package. As explained on <a href="https://semver.org/">their website</a>, incrementing the major version implies a breaking change, a minor increment is a backwards compatible change and lastly patches are mostly applied to bug fixes. This aids users in understanding whether they should continue using a package, whether their package needs updating due to a breaking change or whether they need to install the newest version because a bug was recently fixed.</p>
<p>Examples of changes that correspond to major, minor or patch updates can be seen in the version release notes (NEWS.md file) of <a href="https://github.com/tidyverse/dplyr/blob/main/NEWS.md">{dplyr}</a> and <a href="https://github.com/tidyverse/ggplot2/blob/main/NEWS.md">{ggplot2}</a>.</p>
<p>In R there are several packages that work with versioning, and specifically semantic versioning. The <a href="https://CRAN.R-project.org/package=semver">{semver}</a> package provides functions for parsing, rendering and comparing versions. There is also the <a href="https://CRAN.R-project.org/package=semverutils">{semverutils}</a> R package which provides similar functionality using <code>R6</code>. The <a href="https://CRAN.R-project.org/package=usethis">{usethis}</a> package provides handy utility functions for changing the versions of R packages (<code>usethis::use_version()</code> and <code>usethis::use_dev_version()</code>). R also comes with a <code>package_version()</code> function for creating and validating versions.</p>
<p>Overall semantic versioning provides what they describe as a “formal specification” to facilitate management of package development and the dependencies of that package. It is the most widely-used versioning system and therefore will be understood by a wide variety of users and developers.</p>
<p>Some of the critique raised for semantic versioning is the difficulty of defining how changes correspond to a version increment. Semantic versioning states only breaking changes warrant major releases, but a vast re-write of a code base may also justify a major version change. Different breaking changes have different magnitudes, therefore a change to a single exported function or a change to every exported function will be communicated in a single, equal, version increment.</p>
</section>
<section id="alternatives-to-semantic-versioning" class="level3">
<h3 class="anchored" data-anchor-id="alternatives-to-semantic-versioning">Alternatives to semantic versioning</h3>
<p>There are several other versioning frameworks aside from semantic versioning. One common option is <a href="https://calver.org/">calendar versioning</a> (CalVer). The format of CalVer is usually year-month (YY-MM), or year-month-day (YY-MM-DD), depending on the regularity of releases, and allows appending tags (micros or modifiers, e.g.&nbsp;YY-MM.1).</p>
<p>Other versioning schemes can appear similar to semantic versioning, but do not follow the guidelines around version semantics. In these cases, a bump in the major version may not relate to a breaking change. Additionally, other numbers can be attached to the traditional x.y.z format, such as build numbers. Build number versioning adds an extra number to specify the build (x.y.z.build_number). There are many other variants but covering all versioning systems is outside the scope of this post.</p>
</section>
<section id="versioning-an-r-package" class="level3">
<h3 class="anchored" data-anchor-id="versioning-an-r-package">Versioning an R package</h3>
<p>There are some restrictions on valid version numbers for R packages. The <a href="https://cran.r-project.org/doc/manuals/R-exts.html#The-DESCRIPTION-file">official “Writing R Extensions” guide</a> state:</p>
<blockquote class="blockquote">
<p>This is a sequence of at least two (and usually three) non-negative integers separated by single ‘.’ or ‘-’ characters.</p>
</blockquote>
</section>
<section id="why-version" class="level3">
<h3 class="anchored" data-anchor-id="why-version">Why version?</h3>
<p>The benefits of versioning apply beyond communicating with users and developers. Implementing versioning eases reproducibility by allowing systems to record which version of a language or package was used. In R this can be achieved in several ways, with some popular examples being the <a href="https://rstudio.github.io/renv/index.html">{renv} package</a> and <a href="https://www.docker.com/">docker</a>.</p>
</section>
</section>
<section id="lifecycle-badges" class="level2">
<h2 class="anchored" data-anchor-id="lifecycle-badges">Lifecycle badges</h2>
<p>Badges can be pasted onto visible parts of the code, for example a readme document in the root of the repository, to show the development phase and stability. The three badging systems we will discuss in this post are:</p>
<ul>
<li><a href="https://www.repostatus.org/">RepoStatus</a></li>
<li><a href="https://lifecycle.r-lib.org/">Tidyverse lifecycles</a></li>
<li><a href="https://www.reconverse.org/lifecycle.html">Reconverse lifecyles</a></li>
</ul>
<section id="repostatus" class="level3">
<h3 class="anchored" data-anchor-id="repostatus">RepoStatus</h3>
<p>RepoStatus is a language agnostic set of badges which describe the stages of code development and the possible transitions between those stages.</p>
<p>As shown in the figure below, there are multiple stages to communicate both unstable and stable software. There are also multiple paths between each stage, recognising the varied routes software development can take.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://raw.githubusercontent.com/jantman/repostatus.org/master/gh_pages/images/lifecycle.svg" class="img-fluid figure-img" alt="Flow diagram of the possible transitions from one state to the other in the RepoStatus framework. The flow is not strictly linear as one package can enter and exist stages such as 'suspended', 'abandoned', 'inactive', etc. There a thin green line with the text 'Repo has reached a stable state' between the stages 'concept', 'WIP', 'abandoned', 'suspended' and the stages 'active', 'unsupported', 'inactive'."></p>
<figcaption>RepoStatus badge system. <em>Reused under CC BY-SA 4.0 from <a href="https://www.repostatus.org/">repostatus.org</a></em></figcaption>
</figure>
</div>
</section>
<section id="tidyverse" class="level3">
<h3 class="anchored" data-anchor-id="tidyverse">Tidyverse</h3>
<p>The tidyverse approach is broadly similar to RepoStatus. The {lifecycle} R package contains the description of their process. There are four stages:</p>
<ol type="1">
<li>Experimental</li>
<li>Stable</li>
<li>Superseded (previously called retired)</li>
<li>Deprecated</li>
</ol>
<p>Most code will go through the experimental phase, as it will likely change its API and the number and order of arguments might change. Once code is not going to drastically change (i.e.&nbsp;no breaking changes), at least from a users point of view, it can be labelled stable. In the tidyverse lifecycle schematic, all experimental code transitions to stable code.</p>
<p>The two stages that follow stable are: superseded and deprecated. The former describes a situation in which a new package, a new function or a new argument, depending on the context, has been developed which the developer feels should be used instead of the now superseded code. Superseded code is still developed in the sense that changes to the language or package that may break the function will be fixed as well as bug fixes, but the function will not received ongoing development. The latter, deprecation, is used in cases when the developer thinks that a package or function should not longer be used. This is primarily employed when code is depended on by other software and therefore deleting the code would cause breaks in reverse dependencies. Thus the deprecation warning allows developers of those dependencies time to make the relevant changes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://raw.githubusercontent.com/r-lib/lifecycle/main/vignettes/figures/lifecycle.svg" class="img-fluid figure-img" alt="Flow diagram of the possible transitions from one state to the other in the tidyverse lifecycle framework. Packages will go from experimental to stable, and possibly end up in a superseded or deprecated stage."></p>
<figcaption>{lifecycle} badge system. <em>Reused under MIT license from <a href="https://lifecycle.r-lib.org/articles/stages.html">lifecycles R package</a></em></figcaption>
</figure>
</div>
<p>One of the main differences between the tidyverse lifecycles, compared to the others discussed in this posts is their applicability at different levels in the code. The lifecycle badges can be applied at the package-level (e.g., <a href="https://github.com/tidyverse/stringr">stringr</a>), the function-level (e.g.&nbsp;<a href="https://github.com/tidyverse/dplyr/blob/16b472fb2afc50a87502c2b4ed803e2f5f82b9d6/R/group-trim.R"><code>dplyr::group_trim()</code></a>) or the argument level (e.g., <a href="https://github.com/tidyverse/dplyr/blob/16b472fb2afc50a87502c2b4ed803e2f5f82b9d6/R/across.R#L36"><code>dplyr::across()</code></a>).</p>
<p>Using {lifecycle} in a package can be setup using <code>usethis::use_lifecycle()</code>. The {lifecycle} package not only provides badges, but also informative deprecation notices which communicate to users that a function is not longer supported since a version release of a package. This offers the user a chance to find an alternative function for future use.</p>
<p>The use of deprecation warnings from {lifecycle} leads onto another aspect of tidyverse development: protracted deprecation. There is no fixed rules on how long after a deprecation warning is made to when code should be removed. In the tidyverse, this process is given ample time in order to allow the many developers that utilise tidyverse software to make the necessary changes. Full descriptions of the {lifecycle} package can be found on the <a href="https://lifecycle.r-lib.org/index.html">website</a>, including the deprecated use of questioning and maturing stages.</p>
</section>
<section id="reconverse" class="level3">
<h3 class="anchored" data-anchor-id="reconverse">Reconverse</h3>
<p>Reconverse provides four stages of software development:</p>
<ol type="1">
<li>concept</li>
<li>experimental</li>
<li>maturing</li>
<li>stable</li>
</ol>
<p>A difference between {lifecycle} and reconverse is the explicit connection between semantic versioning and development stage in <a href="https://www.reconverse.org/lifecycle.html">reconverse</a>. The transitions between experimental, maturing and stable are linked to the versioning less than 0.1.0, less than 1.0.0 and greater than 1.0.0, respectively.</p>
</section>
<section id="dynamic-badges" class="level3">
<h3 class="anchored" data-anchor-id="dynamic-badges">Dynamic badges</h3>
<p>All badge frameworks discussed only offer static badges that require developers to manually update as the project moves between phases. This is subject to the maintainers remembering, which can lead to miscommunication about a package’s stage, which may have move on from being experimental, or not been worked on in years but has an active badge.</p>
<p>Dynamics badges, like those offered by <a href="https://shields.io/" class="uri">https://shields.io/</a> give a good indication of how recently the project was changed by showing time since last commit, or the number of commits since last release. These too are not perfect but may better track changes and take the burden of badge updates off the project maintainer.</p>
</section>
</section>
<section id="communicating-development-in-the-epiverse-trace" class="level2">
<h2 class="anchored" data-anchor-id="communicating-development-in-the-epiverse-trace">Communicating development in the Epiverse-TRACE</h2>
<p>Within the Epiverse-TRACE initiative we use semantic versioning and badges to convey to the community interacting with our code at which stage of developement each project is in. We do not have fixed rules on which badges to use and a variety of badges can be found across the repositories in the <a href="https://github.com/epiverse-trace">organisation</a>. For example reconverse badges are used for <a href="https://github.com/epiverse-trace/linelist">{linelist}</a>, RepoStatus badge is used in <a href="https://github.com/epiverse-trace/finalsize">{finalsize}</a>, and tidyverse badges are used in <a href="https://github.com/epiverse-trace/epiparameter">{epiparameter}</a>.</p>
<p>We take this approach as no lifecycle badging system is perfect, each with benefits and downsides. The badges from {lifecycle} are the most common and thus recognisable in R package development, however may not port well to other languages or be familiar to developers coming to R from other frameworks. RepoStatus has the benefit of not being designed for a single language, and it’s number of badges gives greater acuity to the stage of development for a project. This may be especially useful if a package is newly developed and {lifecycle} would describe it as experimental, but RepoStatus provides granularity as to whether it is a concept package, work in progress (WIP) or started but abandoned.</p>
<p>There is some ambiguity in the semantics of the active stage in RepoStatus, which in the definition is “stable, usable state”, but may be misinterpreted as being unstable but actively developed.</p>
<p>Lastly reconverse provides a system akin to {lifecycle} and may be useful for those working in the epidemiology developer space. However, one downside of the reconverse system is there are no clear semantics for a package being deprecated or archived. As with almost all code, at some point development ceases and this stage should be communicated, even if just to say that the package is not being updated inline with developments in the underlying language, in this case R.</p>
<p>There are no plans within Epiverse-TRACE to develop a new badging system as the existing systems cover almost all use cases. In the event that the current development stage cannot be adequately communicated with a single badge from one of the frameworks discussed, a combination of badges can be used. For example, early on in a project adding both the experimental badge from {lifecycle} or reconverse and the WIP badge from RepoStatus may more accurately describe the projects develop pace. Alternatively, the stable badge, from either {lifecycle} or reconverse, can be coupled with either active or inactive from RepoStatus to let other developers know if software will be updated with new language features or dependency deprecations.</p>
<p>Overall, the use of any of the three lifecycle frameworks described here is better than none.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://en.wikipedia.org/wiki/Version_control" class="uri">https://en.wikipedia.org/wiki/Version_control</a>↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{w._lambert2023,
  author = {W. Lambert, Joshua},
  title = {Communicating Development Stages of Open-Source Software},
  date = {2023-07-18},
  url = {https://epiverse-trace.github.io/posts/comm-software-devel/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-w._lambert2023" class="csl-entry quarto-appendix-citeas">
W. Lambert, Joshua. 2023. <span>“Communicating Development Stages of
Open-Source Software.”</span> July 18, 2023. <a href="https://epiverse-trace.github.io/posts/comm-software-devel/">https://epiverse-trace.github.io/posts/comm-software-devel/</a>.
</div></div></section></div> ]]></description>
  <category>open-source</category>
  <category>R</category>
  <category>R package</category>
  <category>versioning</category>
  <category>lifecycles</category>
  <category>community</category>
  <guid>https://epiverse-trace.github.io/posts/comm-software-devel/</guid>
  <pubDate>Tue, 18 Jul 2023 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
